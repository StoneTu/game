window.__require=function t(o,e,n){function i(s,r){if(!e[s]){if(!o[s]){var l=s.split("/");if(l=l[l.length-1],!o[l]){var h="function"==typeof __require&&__require;if(!r&&h)return h(l,!0);if(c)return c(l,!0);throw new Error("Cannot find module '"+s+"'")}}var a=e[s]={exports:{}};o[s][0].call(a.exports,function(t){return i(o[s][1][t]||t)},a,a.exports,t,o,e,n)}return e[s].exports}for(var c="function"==typeof __require&&__require,s=0;s<n.length;s++)i(n[s]);return i}({"atest-settings":[function(t,o,e){"use strict";cc._RF.push(o,"f0eb6lkYctHsK5+G/nxc3Ty","atest-settings"),console.log("Just test"),cc._RF.pop()},{}],"cases-settings":[function(t,o,e){"use strict";cc._RF.push(o,"a6265miA4BICbspTJSVhTyQ","cases-settings"),cc._RF.pop()},{}],char01:[function(t,o,e){"use strict";cc._RF.push(o,"dc643FtvEJOk7wRQD7v4bDA","char01");cc.Class({extends:cc.Component,properties:{body:{default:null,type:cc.Node},Uleg1:{default:null,type:cc.Node},Uleg2:{default:null,type:cc.Node},Lleg1:{default:null,type:cc.Node},Lleg2:{default:null,type:cc.Node},Uarm:{default:null,type:cc.Node}},walkMotion:function(t){this.timer+=t;var o=function(t,o){return t-o*Math.floor(t/o)}(this.timer,2*this.walkSpeed);o<this.walkSpeed&&1!=this.walkStep?(this.walkStep=1,console.log("this.walkStep",this.walkStep),this.bodyJointUleg1.upperAngle=40,this.bodyJointUleg1.maxMotorTorque=500,this.bodyJointUleg1.motorSpeed=50,this.bodyJointUleg1.enableMotor=!0,this.bodyJointUleg2.lowerAngle=-30,this.bodyJointUleg2.maxMotorTorque=-500,this.bodyJointUleg2.motorSpeed=-50,this.bodyJointUleg2.enableMotor=!0,this.Uleg2JointLleg2.lowerAngle=-30,this.Uleg1JointLleg1.lowerAngle=-90):o>this.walkSpeed&&2!=this.walkStep&&(this.walkStep=2,console.log("this.walkStep",this.walkStep),this.bodyJointUleg2.upperAngle=40,this.bodyJointUleg2.maxMotorTorque=500,this.bodyJointUleg2.motorSpeed=50,this.bodyJointUleg2.enableMotor=!0,this.bodyJointUleg1.lowerAngle=-30,this.bodyJointUleg1.maxMotorTorque=-500,this.bodyJointUleg1.motorSpeed=-50,this.bodyJointUleg1.enableMotor=!0,this.Uleg1JointLleg1.lowerAngle=-30,this.Uleg2JointLleg2.lowerAngle=-90)},walkSetting:function(){this.bodyJointUleg1.lowerAngle=-40,this.bodyJointUleg1.upperAngle=40,this.bodyJointUleg2.lowerAngle=-40,this.bodyJointUleg2.upperAngle=40,this.Uleg1JointLleg1.lowerAngle=-90,this.Uleg1JointLleg1.upperAngle=0,this.Uleg2JointLleg2.lowerAngle=-90,this.Uleg2JointLleg2.upperAngle=0},standMotion:function(){this.bodyJointUleg1.lowerAngle=0,this.bodyJointUleg1.upperAngle=0,this.bodyJointUleg2.lowerAngle=0,this.bodyJointUleg2.upperAngle=0,this.Uleg1JointLleg1.lowerAngle=0,this.Uleg1JointLleg1.upperAngle=0,this.Uleg2JointLleg2.lowerAngle=0,this.Uleg2JointLleg2.upperAngle=0},onLoad:function(){this.timer=0,this.walkMotionFlag=!1,this.walkStep=0,this.walkSpeed=2;this.body.getComponent(cc.RigidBody);for(var t=this.Uleg1.getComponent(cc.RigidBody),o=this.Uleg2.getComponent(cc.RigidBody),e=(this.Lleg1.getComponent(cc.RigidBody),this.Lleg2.getComponent(cc.RigidBody),this.Uarm.getComponent(cc.RigidBody)),n=this.body.getComponents(cc.RevoluteJoint),i=0;i<n.length;i++){var c=n[i].connectedBody;c===t?(this.bodyJointUleg1=n[i],this.bodyJointUleg1||console.log("err3")):c===o?(this.bodyJointUleg2=n[i],this.bodyJointUleg2||console.log("err4")):c===e&&(this.bodyJointUarm=n[i])}this.Uleg1JointLleg1=this.Uleg1.getComponents(cc.RevoluteJoint),this.Uleg1JointLleg1||console.log("err1"),this.Uleg2JointLleg2=this.Uleg2.getComponents(cc.RevoluteJoint),this.Uleg2JointLleg2||console.log("err2"),this.Lleg1Jointfoot1=this.Lleg1.getComponents(cc.RevoluteJoint),this.Lleg2Jointfoot2=this.Lleg2.getComponents(cc.RevoluteJoint)},start:function(){},update:function(t){this.bodyJointUleg1.lowerAngle&&(this.walkSetting(),this.walkMotion(t))}}),cc._RF.pop()},{}],char02:[function(t,o,e){"use strict";cc._RF.push(o,"0721376g7FJVK/YvF+ksHUS","char02");cc.Class({extends:cc.Component,properties:{camera:{default:null,type:cc.Node},body:{default:null,type:cc.Node},Uarm:{default:null,type:cc.Node},Larm:{default:null,type:cc.Node},hand:{default:null,type:cc.Node},foot:{default:null,type:cc.Node},handDist:{default:null,type:cc.Node}},handMoveEnable:function(){var t=cc.find("Canvas/background");t&&(t.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),t.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),t.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)),this.handBody=this.hand.getComponent(cc.RigidBody),this.touchPoints=[],this.force=cc.v2(0,0)},onTouchStart:function(t){this.touching=!0,this.touchStartPoint=cc.v2(t.touch.getLocation()),this.handDistStartPoint=this.handDist.position},onTouchMove:function(t){this.touchPoint=cc.v2(t.touch.getLocation()),this.handDistPoint=this.handDist.position,this.mouseDeltaMove=this.touchPoint.sub(this.touchStartPoint)},onTouchEnd:function(t){this.touchPoint=cc.v2(t.touch.getLocation()),this.hand.getComponent("handContact").holdCollider(),this.mouseDeltaMove=void 0},moveBodyLeft:function(){this.footBody.applyForceToCenter(cc.v2(-6e4,0)),this.playAnimation(0),-1===this.charDirection&&(this.setDirectionLeft(),this.charDirection=1)},moveBodyRight:function(){this.footBody.applyForceToCenter(cc.v2(6e4,0)),this.playAnimation(0),1===this.charDirection&&(this.setDirectionRight(),this.charDirection=-1)},moveBodyUp:function(){var t=this.footBody.linearVelocity;Math.abs(t.y)<1&&this.footBody.applyForceToCenter(cc.v2(0,5e5))},setDirectionRight:function(){console.log("setDirectionRight"),this.body.scaleX=1,this.foot.scaleX=1;for(var t=this.body.getComponents(cc.RevoluteJoint),o=0;o<t.length;o++){if(t[o].connectedBody==this.Uarm.getComponent(cc.RigidBody))this.body.removeComponent(t[o]),(n=this.body.addComponent(cc.RevoluteJoint)).lowerAngle=-180,n.upperAngle=0,n.connectedBody=t[o].connectedBody,n.anchor=t[o].anchor,n.connectedAnchor=t[o].connectedAnchor,n.enableLimit=!0}var e=this.Uarm.getComponent(cc.RevoluteJoint);this.Uarm.removeComponent(e),(n=this.Uarm.addComponent(cc.RevoluteJoint)).lowerAngle=-160,n.upperAngle=0,n.connectedBody=e.connectedBody,n.anchor=e.anchor,n.connectedAnchor=e.connectedAnchor,n.enableLimit=!0;var n,i=this.Larm.getComponent(cc.RevoluteJoint);this.Larm.removeComponent(i),(n=this.Larm.addComponent(cc.RevoluteJoint)).lowerAngle=-90,n.upperAngle=0,n.connectedBody=i.connectedBody,n.anchor=i.anchor,n.connectedAnchor=i.connectedAnchor,n.enableLimit=!0},setDirectionLeft:function(){console.log("setDirectionLeft"),this.body.scaleX=-1,this.foot.scaleX=-1;for(var t=this.body.getComponents(cc.RevoluteJoint),o=0;o<t.length;o++){if(t[o].connectedBody==this.Uarm.getComponent(cc.RigidBody))this.body.removeComponent(t[o]),(n=this.body.addComponent(cc.RevoluteJoint)).lowerAngle=0,n.upperAngle=180,n.connectedBody=t[o].connectedBody,n.anchor=t[o].anchor,n.connectedAnchor=t[o].connectedAnchor,n.enableLimit=!0}var e=this.Uarm.getComponent(cc.RevoluteJoint);this.Uarm.removeComponent(e),(n=this.Uarm.addComponent(cc.RevoluteJoint)).lowerAngle=0,n.upperAngle=160,n.connectedBody=e.connectedBody,n.anchor=e.anchor,n.connectedAnchor=e.connectedAnchor,n.enableLimit=!0;var n,i=this.Larm.getComponent(cc.RevoluteJoint);this.Larm.removeComponent(i),(n=this.Larm.addComponent(cc.RevoluteJoint)).lowerAngle=0,n.upperAngle=90,n.connectedBody=i.connectedBody,n.anchor=i.anchor,n.connectedAnchor=i.connectedAnchor,n.enableLimit=!0},playAnimation:function(t){switch(t){case 0:this.footAnim.play("char02_walk");break;default:this.footAnim.stop()}},onLoad:function(){this.handMoveEnable(),this.footBody=this.foot.getComponent(cc.RigidBody);var t=this.foot.getComponent(cc.Animation);this.footAnim=t,this.charDirection=-1},start:function(){},update:function(t){if(this.mouseDeltaMove){var o=this.Uarm.position.add(cc.v2(0,20)),e=o.add(this.mouseDeltaMove);o.sub(e).mag()<100&&(this.handDist.position=e)}this.camera.x=this.foot.position.x,this.camera.y=this.foot.position.y+200}}),cc._RF.pop()},{}],contact:[function(t,o,e){"use strict";cc._RF.push(o,"b97d1udTaFMnaTU9RQC2nPu","contact");function n(t,o){return t.fraction>o.fraction?1:t.fraction<o.fraction?-1:0}function i(t,o,e){return cc.Intersection.pointLineDistance(t,o,e,!0)<1}cc.Class({extends:cc.Component,properties:{materialBrittle:.05},init:function(t){this.gameCtl=t},initCtx:function(t){this.ctx=t},onBeginContact:function(t,o,e){if(o){this.selfCollider=o;var n=t.getWorldManifold(),i=n.points;n.normal;if(i[0]){var c=o.body.getLinearVelocityFromWorldPoint(n.points[0]),s=e.body.getLinearVelocityFromWorldPoint(n.points[0]).sub(c);this.ctx&&(this.ctx.circle(i[0].x,i[0].y,5),this.ctx.fill()),this.calCrash(i[0],s,o)}}},onEndContact:function(t,o,e){},onPreSolve:function(t,o,e){},onPostSolve:function(t,o,e){},calCrash:function(t,o,e){var n=t.add(o.mul(this.materialBrittle)),i=(t=t.sub(o.mul(.01)),cc.director.getPhysicsManager()),c=i.rayCast(t,n,cc.RayCastType.All),s=i.rayCast(n,t,cc.RayCastType.All);this.ctx.clear(),this.ctx.moveTo(t.x,t.y),this.ctx.lineTo(n.x,n.y),this.ctx.stroke(),s.forEach(function(t){t.fraction=1-t.fraction});for(var r=c.concat(s),l=[],h=function(t){for(var o=!1,n=r[t],i=0;i<l.length;i++){var c=l[i];if(c[0]&&n.collider===c[0].collider){o=!0;var s=c.find(function(t){return t.point.sub(n.point).magSqr()<=5});s?c.splice(c.indexOf(s),1):c.push(n);break}}o||n.collider!==e||l.push([n])},a=0;a<r.length;a++)h(a);if(this.pairs=l,r.length>0)for(a=0;a<r.length;a++)this.ctx.circle(r[a].point.x,r[a].point.y,5),this.ctx.fill();for(var d=0;d<this.pairs.length;d++)if(this.pairs[d].length>0)for(var u=0;u<this.pairs[d].length;u++)this.ctx.circle(this.pairs[d][u].point.x,this.pairs[d][u].point.y,5),this.ctx.fill();this.createSplit(this.pairs)},createSplit:function(t){for(var o=this,e=function(e){var i=t[e];if(i.length<2)return"continue";i=i.sort(n);for(var c=[],s=0;s<i.length-1;s+=2){var r=i[s],l=i[s+1];r&&l&&o.split(r.collider,r.point,l.point,c)}if(c.length<=0)return"continue";for(var h=i[0].collider,a=void 0,d=0;d<c.length;d++){for(var u=c[d],p=0;p<u.length;p++)"number"==typeof u[p]&&(u[p]=h.points[u[p]]);(!a||u.length>a.length)&&(a=u)}if(a.length<3)return"continue";h.points=a,h.apply();var f=h.node.getComponent(cc.Graphics);f.clear(),f.moveTo(a[0].x,a[0].y),a.map(function(t){f.lineTo(t.x,t.y)}),f.close(),f.stroke(),f.fillColor=cc.Color.GRAY,f.fill();var C=h.body;o.judgeRemove(C);for(var g=function(t){var e=c[t];if(e.length<3)return"continue";if(e==a)return"continue";var n=new cc.Node;n.position=C.getWorldPosition(),n.rotation=C.getWorldRotation(),n.parent=cc.director.getScene(),(C=n.addComponent(cc.RigidBody)).enabledContactListener=!0,n.addComponent("contact").initCtx(o.ctx);var i=n.addComponent(cc.PhysicsPolygonCollider);i.points=e,i.apply();var s=n.addComponent(cc.Graphics);s.moveTo(e[0].x,e[0].y),e.map(function(t){s.lineTo(t.x,t.y)}),s.close(),s.stroke(),s.fillColor=cc.Color.GRAY,s.fill()},y=0;y<c.length;y++)g(y)},i=0;i<t.length;i++)e(i)},judgeRemove:function(t){t.getMass()<.5&&t.node.destroy()},split:function(t,o,e,n){for(var c=t.body,s=t.points,r=[o=c.getLocalPoint(o),e=c.getLocalPoint(e)],l=[e,o],h=void 0,a=void 0,d=0;d<s.length;d++){var u=s[d],p=d===s.length-1?s[0]:s[d+1];if(void 0===h&&i(o,u,p)?h=d:void 0===a&&i(e,u,p)&&(a=d),void 0!==h&&void 0!==a)break}if(void 0!==h&&void 0!==a){var f=void 0,C=h,g=a;if(n.length>0)for(var y=0;y<n.length;y++){var v=n[y];if(C=v.indexOf(h),g=v.indexOf(a),-1!==C&&-1!==g){f=n.splice(y,1)[0];break}}f||(f=s.map(function(t,o){return o}));for(var m=C+1;m!==g+1;m++){m>=f.length&&(m=0);var T=f[m];(T="number"==typeof T?s[T]:T).sub(o).magSqr()<5||T.sub(e).magSqr()<5||l.push(f[m])}for(var b=g+1;b!==C+1;b++){b>=f.length&&(b=0);var S=f[b];(S="number"==typeof S?s[S]:S).sub(o).magSqr()<5||S.sub(e).magSqr()<5||r.push(f[b])}n.push(r),n.push(l)}},start:function(){}}),cc._RF.pop()},{}],distJointContact:[function(t,o,e){"use strict";cc._RF.push(o,"14a8chhckVHLJ5BxTmO/QMJ","distJointContact");var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};cc.Class({extends:cc.Component,properties:{},initCtx:function(t){this.ctx=t},onBeginContact:function(t,o,e){(t&&(this.contact=t),o&&(this.selfCollider=o),e)&&(this.otherCollider=e,"default"==e.node.group&&this.addSelection(e,this.point))},addSelection:function(t,o){var e=this,i=this.jointCtr.selectColliders.length,c=t.node,s=t.body.getLocalPoint(o);if(i>0)for(var r=0;r<i;r++)if(this.jointCtr.selectColliders[r]===t){var l,h=function(){l=e.jointCtr.selectColliders.slice(r+1),e.jointCtr.selectColliders=l,e.jointCtr.selectAnchors=e.jointCtr.selectAnchors.slice(r+1);var o=c.getComponent(cc.Graphics);return d=o.fillColor,u=t.points,o.clear(),o.moveTo(u[0].x,u[0].y),u.map(function(t){o.lineTo(t.x,t.y)}),o.close(),o.strokeColor=cc.Color.BLACK,o.lineWidth=1,o.stroke(),o.fillColor=d,o.fill(),{v:void 0}}();if("object"===(void 0===h?"undefined":n(h)))return h.v}if(i<=2){this.jointCtr.selectColliders.push(t),this.jointCtr.selectAnchors.push(s);var a=c.getComponent(cc.Graphics),d=a.fillColor,u=t.points;a.clear(),a.moveTo(u[0].x,u[0].y),u.map(function(t){a.lineTo(t.x,t.y)}),a.close(),a.strokeColor=cc.Color.YELLOW,a.lineWidth=5,a.stroke(),a.fillColor=d,a.fill()}},onEndContact:function(t,o,e){this.contact=void 0,this.selfCollider=void 0,this.otherCollider=void 0},onPreSolve:function(t,o,e){},onPostSolve:function(t,o,e){},start:function(){},update:function(t){}}),cc._RF.pop()},{}],distJointObject:[function(t,o,e){"use strict";cc._RF.push(o,"5e0d51Tuq1CN7QtcE2PiWP6","distJointObject"),cc.Class({extends:cc.Component,properties:{camera:{default:null,type:cc.Node},buttonLabel:{default:null,type:cc.Label}},onLoad:function(){this.enableMode=!1,this.ctx=this.getComponent(cc.Graphics),this.touchPoints=[],this.selectColliders=[],this.selectAnchors=[]},initTouch:function(){var t=cc.find("Canvas/paintArea");t&&(t.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),t.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),t.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)),this.enableMode=!0},endTouch:function(){var t=cc.find("Canvas/paintArea");t&&(t.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),t.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),t.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)),this.enableMode=!1},distJointBtn:function(){if(!1===this.enableMode){var t=cc.find("drawManger");t.getComponent("drawPolygon").endTouch(),t.getComponent("staticObject").endTouch(),t.getComponent("weldJointObject").endTouch(),t.getComponent("wheelJointObject").endTouch(),this.initTouch()}else{if(2===this.selectColliders.length){var o=this.selectColliders[0].node,e=(this.selectColliders[1].node,this.selectColliders[1].body),n=o.addComponent(cc.DistanceJoint);n.connectedBody=e,n.anchor=this.selectAnchors[0],n.connectedAnchor=this.selectAnchors[1],n.distance=0,n.frequency=1,n.dampingRatio=0,this.clearColliderColor(this.selectColliders[0]),this.clearColliderColor(this.selectColliders[1]),this.selectColliders=[],this.selectAnchors=[]}}},clearColliderColor:function(t){var o=t.node.getComponent(cc.Graphics),e=o.fillColor,n=t.points;o.clear(),o.moveTo(n[0].x,n[0].y),n.map(function(t){o.lineTo(t.x,t.y)}),o.close(),o.strokeColor=cc.Color.BLACK,o.lineWidth=1,o.stroke(),o.fillColor=e,o.fill()},onTouchStart:function(t){this.touching=!0,this.touchStartPoint=cc.v2(t.touch.getLocation()).add(cc.v2(this.camera.x,this.camera.y)),this.createBody(this.touchStartPoint)},onTouchMove:function(t){this.touchPoint=cc.v2(t.touch.getLocation()).add(cc.v2(this.camera.x,this.camera.y))},onTouchEnd:function(t){this.touchPoint=cc.v2(t.touch.getLocation()).add(cc.v2(this.camera.x,this.camera.y)),this.destroyBody()},createBody:function(t){var o=new cc.Node;o.parent=cc.director.getScene(),o.position=t,o.group="invisible";var e=o.addComponent(cc.RigidBody);e.enabledContactListener=!0,e.type=cc.RigidBodyType.Dynamic,e.gravityScale=0;var n=o.addComponent("distJointContact");n.initCtx(this.ctx),n.jointCtr=this,n.point=t;var i=o.addComponent(cc.PhysicsCircleCollider);i.radius=10,i.sensor=!0,i.apply(),this.touchNode=o},destroyBody:function(){this.touchNode&&this.touchNode.destroy()},start:function(){}}),cc._RF.pop()},{}],drawPolygon:[function(t,o,e){"use strict";cc._RF.push(o,"ddc6ezYF69JVKgsZ318siQM","drawPolygon");cc.Class({extends:cc.Component,onEnable:function(){this.debugDrawFlags=cc.director.getPhysicsManager().debugDrawFlags},onDisable:function(){cc.director.getPhysicsManager().debugDrawFlags=this.debugDrawFlags},properties:{camera:{default:null,type:cc.Node}},onLoad:function(){this.initTouch(),this.enableMode=!0,this.ctx=this.getComponent(cc.Graphics),this.touchPoints=[]},initTouch:function(){var t=cc.find("Canvas/paintArea");t&&(t.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),t.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),t.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)),this.enableMode=!0},endTouch:function(){var t=cc.find("Canvas/paintArea");t&&(t.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),t.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),t.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)),this.enableMode=!1},onTouchStart:function(t){this.touching=!0,this.r1=this.r2=this.results=null,this.touchStartPoint=this.touchPoint=cc.v2(t.touch.getLocation()).add(cc.v2(this.camera.x,this.camera.y))},onTouchMove:function(t){this.touchPoint=cc.v2(t.touch.getLocation()).add(cc.v2(this.camera.x,this.camera.y))},onTouchEnd:function(t){this.touchPoint=cc.v2(t.touch.getLocation()).add(cc.v2(this.camera.x,this.camera.y));var o=this.touchPoint;this.checkPointDist(o)&&(this.ctx.circle(o.x,o.y,5),this.ctx.fill(),this.touchPoints.push(o))},checkPointDist:function(t){var o=!0,e=this.touchPoints.length;if(0==e)return o;for(var n=0;n<e;n++)if(this.touchPoints[n].sub(t).mag()<5)return o=!1;return o},drawPolygonBtn:function(){if(!1===this.enableMode){var t=cc.find("drawManger");t.getComponent("staticObject").endTouch(),t.getComponent("weldJointObject").endTouch(),t.getComponent("distJointObject").endTouch(),t.getComponent("wheelJointObject").endTouch(),this.initTouch()}else this.createBody()},createBody:function(){var t=this.touchPoints;if(this.checkIsPolygon()){var o=new cc.Node;o.parent=cc.director.getScene(),o.addComponent(cc.RigidBody).enabledContactListener=!0,o.addComponent("contact").initCtx(this.ctx);var e=o.addComponent(cc.PhysicsPolygonCollider);e.points=t,e.apply();var n=o.addComponent(cc.Graphics);n.moveTo(t[0].x,t[0].y),t.map(function(t){n.lineTo(t.x,t.y)}),n.close(),n.stroke(),n.fillColor=cc.Color.GRAY,n.fill(),this.touchPoints=[],this.ctx.clear()}},checkIsPolygon:function(){var t=this.touchPoints,o=t.length;if(o<3)return this.touchPoints=[],this.ctx.clear(),!1;for(var e=0;e<o-2;e++)for(var n=e;n<o-3+e;n++){var i=t[e],c=t[e+1],s=n+2>=o?t[n+2-o]:t[n+2],r=n+3>=o?t[n+3-o]:t[n+3];if(!0===cc.Intersection.lineLine(i,c,s,r))return this.touchPoints=[],this.ctx.clear(),!1}return!0},start:function(){},update:function(t){}}),cc._RF.pop()},{}],gameControl:[function(t,o,e){"use strict";cc._RF.push(o,"4e19d/flHBOQrrey6j9KVvB","gameControl");cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.canvas=cc.find("Canvas"),this.scene=cc.director.getScene(),this.timer=3},getChildBody:function(){for(var t=this.scene.children,o=[],e=t.length,n=0;n<e;n++){var i=t[n].getComponent(cc.RigidBody);t[n].getComponent("contact")&&o.push(i)}return o},judgeRemove:function(t){if(t){var o=t.getMass();o<.5&&o>0&&(console.log("remove body",o),t.node.destroy())}},gameOver:function(){this.passDataNode.getComponent("passDataNode").setScore(this.score);var t=cc.instantiate(this.passDataNode);t.parent=null,cc.game.addPersistRootNode(t),cc.director.loadScene("highScore")},start:function(){},update:function(t){if(this.timer-=t,this.timer<0){var o=this.getChildBody(),e=o.length;if(e>0)for(var n=0;n<e;n++)this.judgeRemove(o[n]);this.timer=1}}}),cc._RF.pop()},{}],goalContact:[function(t,o,e){"use strict";cc._RF.push(o,"5d366gm6axHRZH8O6ZfQuAL","goalContact"),cc.Class({extends:cc.Component,properties:{},onBeginContact:function(t,o,e){t&&(this.contact=t),o&&(this.selfCollider=o),e&&(this.otherCollider=e,"elfHouse"==e.node.name&&console.log("Win!"))},onEndContact:function(t,o,e){this.contact=void 0,this.selfCollider=void 0,this.otherCollider=void 0},onPreSolve:function(t,o,e){},onPostSolve:function(t,o,e){},start:function(){},update:function(t){}}),cc._RF.pop()},{}],handContact:[function(t,o,e){"use strict";cc._RF.push(o,"842f84yt8lABIV6vvHJMYFv","handContact"),cc.Class({extends:cc.Component,properties:{},holdCollider:function(){if(this.contact){var t=this.contact;if(this.selfCollider){var o=this.selfCollider;if(this.otherCollider){var e=this.otherCollider;if(t){t.getWorldManifold().points;var n=this.node.addComponent(cc.WeldJoint);n.connectedBody=e.body;var i=o.body.getWorldPosition();i=e.body.getLocalPoint(i),n.connectedAnchor=i,n.frequency=.9}n&&(this.holdJoint=n)}}}},releaseCollider:function(){this.holdJoint&&this.holdJoint.destroy()},onBeginContact:function(t,o,e){t&&(this.contact=t),o&&(this.selfCollider=o),e&&(this.otherCollider=e)},onEndContact:function(t,o,e){this.contact=void 0,this.selfCollider=void 0,this.otherCollider=void 0},onPreSolve:function(t,o,e){},onPostSolve:function(t,o,e){},start:function(){},update:function(t){}}),cc._RF.pop()},{}],"physics-bound":[function(t,o,e){"use strict";cc._RF.push(o,"5679e08EchKg6T/uJg2HuSm","physics-bound");cc.Class({extends:cc.Component,properties:{size:cc.size(0,0),mouseJoint:!1},onLoad:function(){2*this.size.width||this.node.width,this.size.height||this.node.height;var t=new cc.Node;t.group="background",t.addComponent(cc.RigidBody).type=cc.RigidBodyType.Static,t.parent=this.node,cc.Camera.main.backgroundColor=cc.color().fromHEX("#2f69d2")},_addBound:function(t,o,e,n,i){var c=t.addComponent(cc.PhysicsBoxCollider);c.offset.x=o,c.offset.y=e,c.size.width=n,c.size.height=i}}),cc._RF.pop()},{}],"physics-settings":[function(t,o,e){"use strict";cc._RF.push(o,"7d924CjMP9GJaqdIeZjGzMe","physics-settings"),cc.game.on(cc.game.EVENT_ENGINE_INITED,function(){var t=cc.director.getPhysicsManager();t.enabled=!0,t.debugDrawFlags=cc.PhysicsManager.DrawBits.e_jointBit|cc.PhysicsManager.DrawBits.e_shapeBit}),cc._RF.pop()},{}],sensorContact:[function(t,o,e){"use strict";cc._RF.push(o,"2c066BdfZZJVqGXBasWWU3P","sensorContact"),cc.Class({extends:cc.Component,properties:{},initCtx:function(t){this.ctx=t},onBeginContact:function(t,o,e){(t&&(this.contact=t),o)&&(this.selfCollider=o,o.node.group);e&&(this.otherCollider=e,"default"==e.node.group&&this.changeSensor(e))},changeSensor:function(t){t.sensor=!0,t.body.gravityScale=0,t.apply();var o=t.node.getComponent(cc.Graphics);o.fillColor=cc.Color.CYAN,o.fill()},createInvisibleNode:function(t){var o=t.points,e=t.body.getWorldPosition(),n=new cc.Node;n.parent=cc.director.getScene(),n.group="invisible",n.position=e;var i=n.addComponent(cc.RigidBody);i.gravityScale=1,i.enabledContactListener=!0;var c=n.addComponent(cc.PhysicsPolygonCollider);c.points=o,c.apply()},createStaticNode:function(t){var o=t.getComponent(cc.PhysicsPolygonCollider).points,e=new cc.Node;e.parent=cc.director.getScene(),e.group="background",e.addComponent(cc.RigidBody).enabledContactListener=!0;var n=e.addComponent(cc.PhysicsPolygonCollider);n.points=o,n.apply()},onEndContact:function(t,o,e){this.contact=void 0,this.selfCollider=void 0,this.otherCollider=void 0},onPreSolve:function(t,o,e){},onPostSolve:function(t,o,e){},start:function(){},update:function(t){}}),cc._RF.pop()},{}],staticObject:[function(t,o,e){"use strict";cc._RF.push(o,"014d9cju/1P9LUl062scMsH","staticObject"),cc.Class({extends:cc.Component,properties:{camera:{default:null,type:cc.Node}},onLoad:function(){this.enableMode=!1,this.ctx=this.getComponent(cc.Graphics),this.touchPoints=[]},initTouch:function(){var t=cc.find("Canvas/paintArea");t&&(t.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),t.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),t.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)),this.enableMode=!0},endTouch:function(){var t=cc.find("Canvas/paintArea");t&&(t.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),t.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),t.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)),this.enableMode=!1},staticBtn:function(){if(!1===this.enableMode){var t=cc.find("drawManger");t.getComponent("drawPolygon").endTouch(),t.getComponent("weldJointObject").endTouch(),t.getComponent("distJointObject").endTouch(),t.getComponent("wheelJointObject").endTouch(),this.initTouch()}else this.endTouch()},onTouchStart:function(t){this.touching=!0,this.touchStartPoint=cc.v2(t.touch.getLocation()).add(cc.v2(this.camera.x,this.camera.y)),this.createBody(this.touchStartPoint)},onTouchMove:function(t){this.touchPoint=cc.v2(t.touch.getLocation()).add(cc.v2(this.camera.x,this.camera.y))},onTouchEnd:function(t){this.touchPoint=cc.v2(t.touch.getLocation()).add(cc.v2(this.camera.x,this.camera.y)),this.destroyBody()},createBody:function(t){var o=new cc.Node;o.parent=cc.director.getScene(),o.position=t,o.group="invisible";var e=o.addComponent(cc.RigidBody);e.enabledContactListener=!0,e.type=cc.RigidBodyType.Dynamic,e.gravityScale=0,o.addComponent("sensorContact").initCtx(this.ctx);var n=o.addComponent(cc.PhysicsCircleCollider);n.radius=20,n.sensor=!0,n.apply(),this.touchNode=o},destroyBody:function(){this.touchNode&&this.touchNode.destroy()},start:function(){}}),cc._RF.pop()},{}],weldJointContact:[function(t,o,e){"use strict";cc._RF.push(o,"aadfeR+cHJFXoVc81Mx8gNS","weldJointContact");var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};cc.Class({extends:cc.Component,properties:{},initCtx:function(t){this.ctx=t},onBeginContact:function(t,o,e){(t&&(this.contact=t),o&&(this.selfCollider=o),e)&&(this.otherCollider=e,"default"==e.node.group&&this.addSelection(e,this.point))},addSelection:function(t,o){var e=this,i=this.jointCtr.selectColliders.length,c=t.node,s=t.body.getLocalPoint(o);if(i>0)for(var r=0;r<i;r++)if(this.jointCtr.selectColliders[r]===t){var l,h=function(){l=e.jointCtr.selectColliders.slice(r+1),e.jointCtr.selectColliders=l,e.jointCtr.selectAnchors=e.jointCtr.selectAnchors.slice(r+1);var o=c.getComponent(cc.Graphics);return d=o.fillColor,u=t.points,o.clear(),o.moveTo(u[0].x,u[0].y),u.map(function(t){o.lineTo(t.x,t.y)}),o.close(),o.strokeColor=cc.Color.BLACK,o.lineWidth=1,o.stroke(),o.fillColor=d,o.fill(),{v:void 0}}();if("object"===(void 0===h?"undefined":n(h)))return h.v}if(i<=2){this.jointCtr.selectColliders.push(t),this.jointCtr.selectAnchors.push(s);var a=c.getComponent(cc.Graphics),d=a.fillColor,u=t.points;a.clear(),a.moveTo(u[0].x,u[0].y),u.map(function(t){a.lineTo(t.x,t.y)}),a.close(),a.strokeColor=cc.Color.YELLOW,a.lineWidth=5,a.stroke(),a.fillColor=d,a.fill()}},onEndContact:function(t,o,e){this.contact=void 0,this.selfCollider=void 0,this.otherCollider=void 0},onPreSolve:function(t,o,e){},onPostSolve:function(t,o,e){},start:function(){},update:function(t){}}),cc._RF.pop()},{}],weldJointObject:[function(t,o,e){"use strict";cc._RF.push(o,"7703cx/XQBGPIdKZchr1XpY","weldJointObject"),cc.Class({extends:cc.Component,properties:{camera:{default:null,type:cc.Node},buttonLabel:{default:null,type:cc.Label}},onLoad:function(){this.enableMode=!1,this.ctx=this.getComponent(cc.Graphics),this.touchPoints=[],this.selectColliders=[],this.selectAnchors=[]},initTouch:function(){var t=cc.find("Canvas/paintArea");t&&(t.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),t.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),t.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)),this.enableMode=!0},endTouch:function(){var t=cc.find("Canvas/paintArea");t&&(t.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),t.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),t.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)),this.enableMode=!1},weldJointBtn:function(){if(!1===this.enableMode){var t=cc.find("drawManger");t.getComponent("drawPolygon").endTouch(),t.getComponent("staticObject").endTouch(),t.getComponent("distJointObject").endTouch(),t.getComponent("wheelJointObject").endTouch(),this.initTouch()}else{if(2===this.selectColliders.length){var o=this.selectColliders[0].node,e=this.selectColliders[1].node.rotation-o.rotation,n=this.selectColliders[1].body,i=o.addComponent(cc.WeldJoint);i.connectedBody=n,i.anchor=this.selectAnchors[0],i.connectedAnchor=this.selectAnchors[1],i.referenceAngle=e,this.clearColliderColor(this.selectColliders[0]),this.clearColliderColor(this.selectColliders[1]),this.selectColliders=[],this.selectAnchors=[]}}},clearColliderColor:function(t){var o=t.node.getComponent(cc.Graphics),e=o.fillColor,n=t.points;o.clear(),o.moveTo(n[0].x,n[0].y),n.map(function(t){o.lineTo(t.x,t.y)}),o.close(),o.strokeColor=cc.Color.BLACK,o.lineWidth=1,o.stroke(),o.fillColor=e,o.fill()},onTouchStart:function(t){this.touching=!0,this.touchStartPoint=cc.v2(t.touch.getLocation()).add(cc.v2(this.camera.x,this.camera.y)),this.createBody(this.touchStartPoint)},onTouchMove:function(t){this.touchPoint=cc.v2(t.touch.getLocation()).add(cc.v2(this.camera.x,this.camera.y))},onTouchEnd:function(t){this.touchPoint=cc.v2(t.touch.getLocation()).add(cc.v2(this.camera.x,this.camera.y)),this.destroyBody()},createBody:function(t){var o=new cc.Node;o.parent=cc.director.getScene(),o.position=t,o.group="invisible";var e=o.addComponent(cc.RigidBody);e.enabledContactListener=!0,e.type=cc.RigidBodyType.Dynamic,e.gravityScale=0;var n=o.addComponent("weldJointContact");n.initCtx(this.ctx),n.jointCtr=this,n.point=t;var i=o.addComponent(cc.PhysicsCircleCollider);i.radius=10,i.sensor=!0,i.apply(),this.touchNode=o},destroyBody:function(){this.touchNode&&this.touchNode.destroy()},start:function(){}}),cc._RF.pop()},{}],wheelJointContact:[function(t,o,e){"use strict";cc._RF.push(o,"e3778fzqkVHUotdT7rDX+eC","wheelJointContact");var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};cc.Class({extends:cc.Component,properties:{},initCtx:function(t){this.ctx=t},onBeginContact:function(t,o,e){(t&&(this.contact=t),o&&(this.selfCollider=o),e)&&(this.otherCollider=e,"default"==e.node.group&&this.addSelection(e,this.point))},addSelection:function(t,o){var e=this,i=this.jointCtr.selectColliders.length,c=t.node,s=t.body.getLocalPoint(o);if(i>0)for(var r=0;r<i;r++)if(this.jointCtr.selectColliders[r]===t){var l,h=function(){l=e.jointCtr.selectColliders.slice(r+1),e.jointCtr.selectColliders=l,e.jointCtr.selectAnchors=e.jointCtr.selectAnchors.slice(r+1);var o=c.getComponent(cc.Graphics);return d=o.fillColor,u=t.points,o.clear(),o.moveTo(u[0].x,u[0].y),u.map(function(t){o.lineTo(t.x,t.y)}),o.close(),o.strokeColor=cc.Color.BLACK,o.lineWidth=1,o.stroke(),o.fillColor=d,o.fill(),{v:void 0}}();if("object"===(void 0===h?"undefined":n(h)))return h.v}if(i<=2){this.jointCtr.selectColliders.push(t),this.jointCtr.selectAnchors.push(s);var a=c.getComponent(cc.Graphics),d=a.fillColor,u=t.points;a.clear(),a.moveTo(u[0].x,u[0].y),u.map(function(t){a.lineTo(t.x,t.y)}),a.close(),a.strokeColor=cc.Color.YELLOW,a.lineWidth=5,a.stroke(),a.fillColor=d,a.fill()}},onEndContact:function(t,o,e){this.contact=void 0,this.selfCollider=void 0,this.otherCollider=void 0},onPreSolve:function(t,o,e){},onPostSolve:function(t,o,e){},start:function(){},update:function(t){}}),cc._RF.pop()},{}],wheelJointObject:[function(t,o,e){"use strict";cc._RF.push(o,"16187vgXAhHmo0o+JXpAkOY","wheelJointObject"),cc.Class({extends:cc.Component,properties:{camera:{default:null,type:cc.Node},buttonLabel:{default:null,type:cc.Label}},onLoad:function(){this.enableMode=!1,this.ctx=this.getComponent(cc.Graphics),this.touchPoints=[],this.selectColliders=[],this.selectAnchors=[]},initTouch:function(){var t=cc.find("Canvas/paintArea");t&&(t.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),t.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),t.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)),this.enableMode=!0},endTouch:function(){var t=cc.find("Canvas/paintArea");t&&(t.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),t.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),t.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)),this.enableMode=!1},wheelJointBtn:function(){if(!1===this.enableMode){var t=cc.find("drawManger");t.getComponent("drawPolygon").endTouch(),t.getComponent("staticObject").endTouch(),t.getComponent("weldJointObject").endTouch(),t.getComponent("distJointObject").endTouch(),this.initTouch()}else{if(2===this.selectColliders.length){var o=this.selectColliders[0].node,e=(this.selectColliders[1].node,this.selectColliders[1].body),n=o.addComponent(cc.WheelJoint);n.connectedBody=e,n.anchor=this.selectAnchors[0],n.connectedAnchor=this.selectAnchors[1],n.frequency=20,n.dampingRatio=2,this.clearColliderColor(this.selectColliders[0]),this.clearColliderColor(this.selectColliders[1]),this.selectColliders=[],this.selectAnchors=[]}}},clearColliderColor:function(t){var o=t.node.getComponent(cc.Graphics),e=o.fillColor,n=t.points;o.clear(),o.moveTo(n[0].x,n[0].y),n.map(function(t){o.lineTo(t.x,t.y)}),o.close(),o.strokeColor=cc.Color.BLACK,o.lineWidth=1,o.stroke(),o.fillColor=e,o.fill()},onTouchStart:function(t){this.touching=!0,this.touchStartPoint=cc.v2(t.touch.getLocation()).add(cc.v2(this.camera.x,this.camera.y)),this.createBody(this.touchStartPoint)},onTouchMove:function(t){this.touchPoint=cc.v2(t.touch.getLocation()).add(cc.v2(this.camera.x,this.camera.y))},onTouchEnd:function(t){this.touchPoint=cc.v2(t.touch.getLocation()).add(cc.v2(this.camera.x,this.camera.y)),this.destroyBody()},createBody:function(t){var o=new cc.Node;o.parent=cc.director.getScene(),o.position=t,o.group="invisible";var e=o.addComponent(cc.RigidBody);e.enabledContactListener=!0,e.type=cc.RigidBodyType.Dynamic,e.gravityScale=0;var n=o.addComponent("wheelJointContact");n.initCtx(this.ctx),n.jointCtr=this,n.point=t;var i=o.addComponent(cc.PhysicsCircleCollider);i.radius=10,i.sensor=!0,i.apply(),this.touchNode=o},destroyBody:function(){this.touchNode&&this.touchNode.destroy()},start:function(){}}),cc._RF.pop()},{}]},{},["atest-settings","cases-settings","char01","char02","gameControl","goalContact","handContact","physics-bound","physics-settings","contact","distJointContact","distJointObject","drawPolygon","sensorContact","staticObject","weldJointContact","weldJointObject","wheelJointContact","wheelJointObject"]);