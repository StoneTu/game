window.__require=function t(e,s,o){function i(a,c){if(!s[a]){if(!e[a]){var r=a.split("/");if(r=r[r.length-1],!e[r]){var h="function"==typeof __require&&__require;if(!c&&h)return h(r,!0);if(n)return n(r,!0);throw new Error("Cannot find module '"+a+"'")}}var l=s[a]={exports:{}};e[a][0].call(l.exports,function(t){return i(e[a][1][t]||t)},l,l.exports,t,e,s,o)}return s[a].exports}for(var n="function"==typeof __require&&__require,a=0;a<o.length;a++)i(o[a]);return i}({background:[function(t,e,s){"use strict";cc._RF.push(e,"f981em26LFBn5jLsZ4C7T5x","background"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}],ball:[function(t,e,s){"use strict";cc._RF.push(e,"66483BW34hMsZErVNGXZ0x6","ball"),cc.Class({extends:cc.Component,properties:{keepTime:0,scoreDelayTime:0},onLoad:function(){this.timer=0,this.isDestroy=!1,this.gainScore=0},start:function(){},delayAndGainSorce:function(t){this.gainScore=t},update:function(t){if(!1===this.isDestroy){if(this.timer>this.scoreDelayTime&&this.gainScore&&(this.game.gainScore(this.gainScore),this.gainScore=0),this.timer>this.keepTime)return this.node.removeFromParent(),this.isDestroy=!0,void this.node.destroy();this.timer+=t}}}),cc._RF.pop()},{}],game:[function(t,e,s){"use strict";cc._RF.push(e,"eaaa5nlZJRPp5YQW2uWa1s/","game"),cc.Class({extends:cc.Component,properties:{ballPrefab:{default:null,type:cc.Prefab},yellowBrickPrefab:{default:null,type:cc.Prefab},player:{default:null,type:cc.Node},background:{default:null,type:cc.Node},basket:{default:null,type:cc.Node},timerDisplay:{default:null,type:cc.Label},scoreDisplay:{default:null,type:cc.Label},levelDisplay:{default:null,type:cc.Label},scoreAudio:{default:null,type:cc.AudioClip},passDataNode:{default:null,type:cc.Node}},onLoad:function(){this.level=0,this.brickCount=0;var t=this.player.getComponent("player");this.newPlayer=t,this.newPlayer.game=this;var e=this.background.getComponent("background");this.newBackground=e},start:function(){this.timer=30,this.score=0,this.nextLevel()},nextLevel:function(){this.timer+=20;var t=[2,3,4,5,8,10];this.brickCount=0,this.levelBrickCount=t[this.level],this.level>=t.length?this.gameOver():(this.generateYellowBrick(t[this.level]),this.level++)},countBrick:function(){this.brickCount++,this.brickCount>=this.levelBrickCount&&(this.nextLevel(),this.levelDisplay.string="Level: "+Math.round(this.level).toString())},generateYellowBrick:function(t){var e=[];this.newPlayer.yellowBrick=[];for(var s=0;s<t;){var o=62,i=-62;do{o=510*Math.random()-80,i=195*Math.random()-215;var n=this.newPlayer.threePointsCheck(o,i),a=!1;if(e.length>0)for(var c=0;c<e.length;){cc.v2(o,i).sub(e[c].mag())<200&&(a=!0),c++}}while(n||a);e.push(cc.v2(o,i));var r=cc.instantiate(this.yellowBrickPrefab);this.newBackground.node.addChild(r),r.setPosition(e[s]),r.getComponent("yellowBrick").game=this,this.newPlayer.yellowBrick.push(r.getComponent("yellowBrick")),s++}},generateNewBall:function(t){var e=cc.instantiate(this.ballPrefab);this.newBackground.node.addChild(e),e.setPosition(this.getNewBallPosition()),this.newPlayer.ball=e.getComponent("ball"),this.newPlayer.ball.delayAndGainSorce(t),e.getComponent("ball").game=this},getNewBallPosition:function(){var t=this.player.x-this.background.x,e=this.player.y-this.background.y;return e+=this.newPlayer.ballOffsetY,cc.v2(t,e)},gainScore:function(t){this.score=this.score+t,this.scoreDisplay.string="Score: "+this.score.toString(),cc.audioEngine.playEffect(this.scoreAudio,!1)},gameOver:function(){console.log(this.passDataNode.getComponent("passDataNode").passDataScore),this.passDataNode.getComponent("passDataNode").setScore(this.score),console.log(this.passDataNode.getComponent("passDataNode").passDataScore);var t=cc.instantiate(this.passDataNode);t.parent=null,cc.game.addPersistRootNode(t),this.player.stopAllActions(),cc.director.loadScene("highScore")},update:function(t){this.timer<=0?this.gameOver():(this.timer-=t,this.timerDisplay.string="Time: "+Math.round(this.timer).toString(),this.newPlayer.currentStatus!=this.newPlayer.previousStatus&&(this.newPlayer.playAnimation(this.newPlayer.currentStatus),this.newPlayer.previousStatus=this.newPlayer.currentStatus))}}),cc._RF.pop()},{}],highScore:[function(t,e,s){"use strict";cc._RF.push(e,"1e522tN2GZM8aeVDFcc3UIO","highScore"),cc.Class({extends:cc.Component,properties:{nameDisplay1:{default:null,type:cc.Label},nameDisplay2:{default:null,type:cc.Label},scoreDisplay1:{default:null,type:cc.Label},scoreDisplay2:{default:null,type:cc.Label},userScoreDisplay:{default:null,type:cc.Label}},onLoad:function(){var t=JSON.parse(cc.sys.localStorage.getItem("scoreData"));try{t.name1}catch(e){t={name1:"Frank",score1:3,name2:"John",score2:1};cc.sys.localStorage.setItem("scoreData",JSON.stringify(t))}this.nameDisplay1.string=t.name1,this.nameDisplay2.string=t.name2,this.scoreDisplay1.string=t.score1,this.scoreDisplay2.string=t.score2,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this),this.newNode=cc.director.getScene().getChildByName("passDataNode").getComponent("passDataNode"),this.userScoreDisplay.string="Your score: "+this.newNode.passDataScore.toString(),this.isHighScore=this.rankTheScore(t,this.newNode.passDataScore)},start:function(){},rankTheScore:function(t,e){return e>t.score2?(this.node.getChildByName("nameInputBox").getComponent(cc.EditBox).string="Enter your name",!0):(this.node.getChildByName("confirmButton").getChildByName("Background").getChildByName("Label").getComponent(cc.Label).string="Restart",this.node.getChildByName("nameInputBox").getComponent(cc.EditBox).string="You can do better!",this.node.getChildByName("nameInputBox").getComponent(cc.EditBox).destroy(),!1)},rankAndSaveScore:function(t,e){var s=JSON.parse(cc.sys.localStorage.getItem("scoreData"));e>s.score1?(s.score2=s.score1,s.name2=s.name1,s.score1=e,s.name1=t):e>s.score2&&(s.score2=e,s.name2=t),cc.sys.localStorage.setItem("scoreData",JSON.stringify(s)),this.nameDisplay1.string=s.name1,this.nameDisplay2.string=s.name2,this.scoreDisplay1.string=s.score1,this.scoreDisplay2.string=s.score2,this.node.getChildByName("confirmButton").getChildByName("Background").getChildByName("Label").getComponent(cc.Label).string="Restart",this.isHighScore=!1,this.node.getChildByName("nameInputBox").getComponent(cc.EditBox).destroy()},btnClick1:function(t,e){var s=t.target;s.getComponent(cc.Button);if(cc.log("node=",s.name," event=",t.type," data=",e),this.isHighScore){var o=this.node.getChildByName("nameInputBox").getComponent(cc.EditBox).string;this.rankAndSaveScore(o,this.newNode.passDataScore)}else this.restartGame()},restartGame:function(){cc.director.loadScene("basketballField"),cc.game.removePersistRootNode(cc.director.getScene().getChildByName("passDataNode"))},onKeyDown:function(t){},onKeyUp:function(t){switch(t.keyCode){case cc.macro.KEY.r:this.restartGame();break;case cc.macro.KEY.e:cc.sys.localStorage.removeItem("scoreData")}}}),cc._RF.pop()},{}],passDataNode:[function(t,e,s){"use strict";cc._RF.push(e,"8726cTm4bpDurlxBcJ9GB95","passDataNode"),cc.Class({extends:cc.Component,properties:{passDataScore:0},setScore:function(t){this.passDataScore=t},onLoad:function(){},start:function(){}}),cc._RF.pop()},{}],player:[function(t,e,s){"use strict";cc._RF.push(e,"280c3rsZJJKnZ9RqbALVwtK","player"),cc.Class({extends:cc.Component,properties:{moveSpeed:0,accel:0,shootMinLimit:0,shootMaxLimit:0,ballOffsetY:0,basketFakeX:0,basketFakeY:0,basketX:0,basketY:0,judgeHitRange:0,rangeParm:0,flyDuration:0,backgroundX:0,backgroundY:0,outMessageFlag:!1,outMessage:"on going!",mainCamera:{default:null,type:cc.Node}},onLoad:function(){var t=this.getComponent(cc.Animation);t.play("stand"),this.anim=t,this.xSpeed=0,this.ySpeed=0,this.movLeft=!1,this.movRight=!1,this.movUp=!1,this.movDown=!1,this.shootKey=!1,this.currentStatus=0,this.previousStatus=0,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},getCurrentStatus:function(){return this.currentStatus},playAnimation:function(t){switch(t){case 0:this.anim.play("stand");break;case 1:this.anim.play("move");break;case 2:this.anim.play("shoot");break;default:this.anim.play("stand")}},shootAction:function(){if(console.log("shoot power count: ",this.shootPowerCount),this.shootPowerCount<this.shootMinLimit)this.shootEndAction();else if(this.shootPowerCount>this.shootMinLimit&&this.shootPowerCount<this.shootMaxLimit){var t=this.judgeHitOrMiss();this.game.generateNewBall(t),this.ballFlyAnimation(this.shootStatus),this.shootEndAction()}},shootEndAction:function(){},judgeHitOrMiss:function(){this.shootTheta=Math.abs(Math.atan((this.node.y-this.ballOffsetY-this.basketFakeY)/(this.node.x-this.basketFakeX))),console.log(this.shootTheta);var t=(this.basketX-this.node.x)/Math.abs(this.basketX-this.node.x),e=(this.basketFakeY-(this.node.y-this.ballOffsetY))/Math.abs(this.basketFakeY-(this.node.y-this.ballOffsetY));this.shootThetaVector=cc.v2(t,e),this.ballShootCounter=this.shootPowerCount>1.25?2-this.shootPowerCount:this.shootPowerCount-.5;var s=Math.sin(this.shootTheta)*this.shootThetaVector.y*this.ballShootCounter*this.rangeParm+this.node.y-this.ballOffsetY,o=Math.cos(this.shootTheta)*this.shootThetaVector.x*this.ballShootCounter*this.rangeParm+this.node.x;this.shootEndVector=cc.v2(o,s),console.log("shootEnd:",this.shootEndVector.toString());var i=cc.v2(this.basketFakeX,this.basketFakeY),n=this.shootEndVector.sub(i).mag();if(n<this.judgeHitRange){this.shootStatus=2;for(var a=this.threePointsCheck(this.node.x,this.node.y)?3:2,c=0;c<this.yellowBrick.length;)this.yellowBrick[c].judgeShootOnBrick()&&(a=5),c++;return a}return n<1.5*this.judgeHitRange?(this.shootStatus=1,0):(this.shootStatus=0,0)},ballFlyAnimation:function(t){var e=[60,100,60,0],s=[];switch(t){case 2:for(var o=1,i=e.length;o<i+1;){var n=(this.basketX-this.node.x)*o/i+this.node.x+this.backgroundX,a=(this.basketY-this.node.y-this.ballOffsetY)*o/i+this.node.y+this.ballOffsetY+e[o-1]+this.backgroundY,c=cc.moveTo(this.flyDuration,cc.v2(n,a));s.push(c),o++}s.push(cc.moveTo(2*this.flyDuration,cc.v2(this.basketX+this.backgroundX,this.basketY-170+this.backgroundY)));break;case 1:for(o=1,i=e.length;o<i+1;){n=(this.basketX-this.node.x)*o/i+this.node.x+this.backgroundX,a=(this.basketY-this.node.y-this.ballOffsetY)*o/i+this.node.y+this.ballOffsetY+e[o-1]+this.backgroundY,c=cc.moveTo(this.flyDuration,cc.v2(n,a));s.push(c),o++}var r=2*Math.random()-1;for(o=1;o<i+1;){n=r*this.ballShootCounter*this.rangeParm*o/i+this.basketX+this.backgroundX,a=r*this.ballShootCounter*this.rangeParm*o/i+this.basketY+this.ballOffsetY+e[o-1]+this.backgroundY,c=cc.moveTo(this.flyDuration/2,cc.v2(n,a));s.push(c),o++}break;case 0:var h=Math.abs(Math.atan((this.node.y+this.ballOffsetY-this.basketY)/(this.node.x-this.basketX)));for(o=1,i=e.length;o<i+1;){n=Math.cos(h)*this.shootThetaVector.x*this.ballShootCounter*this.rangeParm*o/i+this.node.x+this.backgroundX,a=Math.sin(h)*this.shootThetaVector.y*this.ballShootCounter*this.rangeParm*o/i+this.node.y+this.ballOffsetY+e[o-1]+this.backgroundY,c=cc.moveTo(this.flyDuration,cc.v2(n,a));s.push(c),o++}n=Math.cos(h)*this.shootThetaVector.x*this.ballShootCounter*this.rangeParm*(i+2)/i+this.node.x+this.backgroundX,a=Math.sin(h)*this.shootThetaVector.y*this.ballShootCounter*this.rangeParm*(i+2)/i+this.node.y+this.ballOffsetY-100;s.push(cc.moveTo(this.flyDuration,cc.v2(n,a)))}this.ball.node.runAction(cc.sequence(s))},threePointsCheck:function(t,e){var s=!0;return.659*t+e>-240.15&&-2.97*t+e<300.34&&-.35*t+e<-6.48&&.08*t+e<31.18&&.36*t+e<121.15&&-.35*t+e>-216.89&&(s=!1),s},onDestroy:function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},start:function(){},leftBtn:function(){!0===this.movLeft?(this.movLeft=!1,this.currentStatus=0):!1===this.movLeft&&(this.movLeft=!0,this.currentStatus=1)},rightBtn:function(){!0===this.movRight?(this.movRight=!1,this.currentStatus=0):!1===this.movRight&&(this.movRight=!0,this.currentStatus=1)},upBtn:function(){!0===this.movUp?(this.movUp=!1,this.currentStatus=0):!1===this.movUp&&(this.movUp=!0,this.currentStatus=1)},downBtn:function(){!0===this.movDown?(this.movDown=!1,this.currentStatus=0):!1===this.movDown&&(this.movDown=!0,this.currentStatus=1)},shootBtn:function(){!1===this.shootKey?(this.currentStatus=2,this.shootPowerCount=0,this.shootKey=!0):!0===this.shootKey&&(this.currentStatus=0,this.shootAction(),this.shootKey=!1)},onKeyDown:function(t){switch(t.keyCode){case cc.macro.KEY.a:this.movLeft=!0,this.currentStatus=1;break;case cc.macro.KEY.d:this.movRight=!0,this.currentStatus=1;break;case cc.macro.KEY.w:this.movUp=!0,this.currentStatus=1;break;case cc.macro.KEY.x:this.movDown=!0,this.currentStatus=1;break;case cc.macro.KEY.space:this.currentStatus=2,!1===this.shootKey&&(this.shootPowerCount=0,this.shootKey=!0)}},onKeyUp:function(t){switch(t.keyCode){case cc.macro.KEY.a:this.movLeft=!1,this.currentStatus=0;break;case cc.macro.KEY.d:this.movRight=!1,this.currentStatus=0;break;case cc.macro.KEY.w:this.movUp=!1,this.currentStatus=0;break;case cc.macro.KEY.x:this.movDown=!1,this.currentStatus=0;break;case cc.macro.KEY.space:this.currentStatus=0,this.shootAction(),this.shootKey=!1}},update:function(t){this.movLeft?this.xSpeed=-this.moveSpeed*t:this.movRight?this.xSpeed=this.moveSpeed*t:this.movUp?this.ySpeed=this.moveSpeed*t:this.movDown?this.ySpeed=-this.moveSpeed*t:(this.xSpeed=0,this.ySpeed=0),2===this.currentStatus&&(this.shootPowerCount+=t),this.node.x+=this.xSpeed*t,this.node.y+=this.ySpeed*t,this.mainCamera.x=this.node.x}}),cc._RF.pop()},{}],yellowBrick:[function(t,e,s){"use strict";cc._RF.push(e,"254b3jlbf5K9o2NRDXWmfX6","yellowBrick"),cc.Class({extends:cc.Component,properties:{scoreRadius:0,scoreDelayTime:0},onLoad:function(){this.timer=0,this.isScored=!1,this.isDestroy=!1},start:function(){},getPlayerDistance:function(){var t=this.game.player.getPosition(),e=this.node.position.sub(t).mag();return console.log("Score in brick dist:",e),e},judgeShootOnBrick:function(){return!this.isScored&&(this.getPlayerDistance()<this.scoreRadius?(this.isScored=!0,this.isScored):void 0)},update:function(t){if(this.isScored&&!this.isDestroy){if(this.timer>this.scoreDelayTime)return this.node.removeFromParent(),this.game.countBrick(),void(this.isDestroy=!0);this.timer+=t}}}),cc._RF.pop()},{}]},{},["background","ball","game","highScore","passDataNode","player","yellowBrick"]);