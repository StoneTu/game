window.__require=function e(t,i,o){function c(s,n){if(!i[s]){if(!t[s]){var a=s.split("/");if(a=a[a.length-1],!t[a]){var h="function"==typeof __require&&__require;if(!n&&h)return h(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+s+"'")}}var l=i[s]={exports:{}};t[s][0].call(l.exports,function(e){return c(t[s][1][e]||e)},l,l.exports,e,t,i,o)}return i[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<o.length;s++)c(o[s]);return c}({board1:[function(e,t,i){"use strict";cc._RF.push(t,"369043au/1Ch4L79wobM+po","board1");cc.Class({extends:cc.Component,properties:{restartBtn:{default:null,type:cc.Node},levelLabel:{default:null,type:cc.Label}},onLoad:function(){this.pieces=[[cc.v2(0,0),cc.v2(-1,0),cc.v2(-1,-1),cc.v2(1,0),cc.v2(2,0)],[cc.v2(0,0),cc.v2(0,-1),cc.v2(0,1),cc.v2(1,0),cc.v2(-1,0)],[cc.v2(0,0),cc.v2(-1,0),cc.v2(-1,-1),cc.v2(1,0),cc.v2(1,-1)],[cc.v2(0,0),cc.v2(0,1),cc.v2(1,0),cc.v2(1,-1),cc.v2(-1,1)],[cc.v2(0,0),cc.v2(0,-1),cc.v2(0,-2),cc.v2(1,0),cc.v2(2,0)],[cc.v2(0,0),cc.v2(0,-1),cc.v2(-1,0),cc.v2(1,0),cc.v2(2,0)],[cc.v2(0,0),cc.v2(-1,0),cc.v2(0,1),cc.v2(1,0),cc.v2(1,1)],[cc.v2(0,0),cc.v2(0,-1),cc.v2(-1,-1),cc.v2(1,0),cc.v2(2,0)],[cc.v2(0,0),cc.v2(0,-1),cc.v2(0,1),cc.v2(0,2)],[cc.v2(0,0),cc.v2(0,1),cc.v2(0,2),cc.v2(1,0)],[cc.v2(0,0),cc.v2(0,1),cc.v2(1,0),cc.v2(1,1)],[cc.v2(0,0),cc.v2(0,1),cc.v2(1,0)]],this.piecesColor=[new cc.Color(255,90,200),cc.Color.RED,cc.Color.GRAY,new cc.Color(255,100,0),new cc.Color(0,0,100),cc.Color.GREEN,cc.Color.BLUE,cc.Color.MAGENTA,new cc.Color(0,100,0),new cc.Color(65,65,65),cc.Color.YELLOW,new cc.Color(255,100,155)],this.originPosition=cc.v2(0,250),this.graphic=this.node.addComponent(cc.Graphics),this.createEmptyBoard(),this.drawChessBoard(),this.createOutsideSlot(),this.createPieces(),this.onSelectNode=this.pieceNode[0],this.restartBtn.zIndex=99,this.generateLevel()},restartAction:function(){cc.director.loadScene("menu")},pieceCW:function(){this.onSelectNode.getComponent("piece1").turnBallNodeCW()},pieceCCW:function(){this.onSelectNode.getComponent("piece1").turnBallNodeCCW()},pieceFlip:function(){this.onSelectNode.getComponent("piece1").turnBallNodeFlip()},menuAction:function(){cc.director.loadScene("menu")},start:function(){},createPieces:function(){this.pieceNode=[];for(var e=0;e<this.pieces.length;e++){var t=new cc.Node("piece");t.scriptNode=t.addComponent("piece1"),t.scriptNode.init(this.pieces[e],this.piecesColor[e]),t.scriptNode.home=this,t.parent=cc.find("Canvas"),t.setPosition(this.outsideSlot[e].position),t.dragable=!0,t.zIndex=99,this.pieceNode.push(t)}},resetPiecePos:function(){for(var e=0;e<this.pieceNode.length;e++)this.pieceNode[e].scriptNode.restPiece(this.pieces[e]),this.pieceNode[e].setPosition(this.outsideSlot[e].position);for(var t=this.boardNode.length,i=0;i<t;i++)for(var o=this.boardNode[i].length,c=0;c<o;c++)this.boardNode[i][c].withPiece=!1;this.levelLabel.getComponent(cc.Label).string="Level "},createEmptyBoard:function(){this.board=[];for(var e=10;e>0;e--){for(var t=[],i=0;i<e;i++){t.push(0)}this.board.push(t)}},drawChessBoard:function(){this.boardNode=[];for(var e=this.board.length,t=0;t<e;t++){for(var i=[],o=this.board[t].length,c=0;c<o;c++){var r=this.calPosition(this.originPosition,t,c),s=new cc.Node("boardSlot");s.parent=cc.find("Canvas"),s.setPosition(r),s.zIndex=0,s.withPiece=!1,i.push(s),this.drawSpot(r,new cc.Color(30,30,30))}this.boardNode.push(i)}},calPosition:function(e,t,i){var o=-1*Math.sqrt(2)*20,c=e.x+o*t*-1+o*i,r=e.y+o*t+o*i;return cc.v2(c,r)},drawSpot:function(e,t){this.graphic.fillColor=t,this.graphic.circle(e.x,e.y,20),this.graphic.stroke(),this.graphic.fill()},createOutsideSlot:function(){this.outsideSlot=[];for(var e=cc.v2(-320,-230),t=0;t<6;t++)for(var i=0;i<2;i++){var o=e.add(cc.v2(130*t,130*i)),c=new cc.Node("outsideSlot");c.parent=cc.find("Canvas"),c.setPosition(o),c.zIndex=1;var r=c.addComponent(cc.Graphics);r.moveTo(-65,65),r.lineTo(65,65),r.lineTo(65,-65),r.lineTo(-65,-65),r.close(),r.strokeColor=cc.Color.GRAY,r.stroke(),this.outsideSlot.push(c)}},checkWin:function(){for(var e=this.boardNode.length,t=0;t<e;t++)for(var i=this.boardNode[t].length,o=0;o<i;o++)if(!this.boardNode[t][o].withPiece)return!1;return this.restartBtn.active=!0,!0},nextLevel:function(){this.resetPiecePos();var e=this.levelArray.length;this.currentLevel<e-1?this.currentLevel++:this.currentLevel=0,this.executeLevel(this.currentLevel)},executeLevel:function(e){this.levelLabel.getComponent(cc.Label).string="Level "+e;for(var t=this.levelArray[e].length,i=0;i<t;i++)this.movePiece(this.levelArray[e][i][0],this.levelArray[e][i][1],this.levelArray[e][i][2],this.levelArray[e][i][3])},movePiece:function(e,t,i,o){var c=!0,r=!1,s=void 0;try{for(var n,a=t[Symbol.iterator]();!(c=(n=a.next()).done);c=!0)switch(n.value){case 0:this.pieceNode[e].scriptNode.turnBallNodeCW();break;case 1:this.pieceNode[e].scriptNode.turnBallNodeCCW();break;case 2:this.pieceNode[e].scriptNode.turnBallNodeFlip()}}catch(e){r=!0,s=e}finally{try{!c&&a.return&&a.return()}finally{if(r)throw s}}this.pieceNode[e].scriptNode.movePiece(i,o)},generateLevel:function(){var e,t;this.levelArray=[],(e=[]).push(t=[4,[0],0,0]),t=[9,[-1],0,3],e.push(t),t=[3,[0,0],2,4],e.push(t),t=[5,[1,2],0,8],e.push(t),t=[10,[-1],1,6],e.push(t),t=[6,[0,0],2,2],e.push(t),this.levelArray.push(e),(e=[]).push(t=[2,[0],0,1]),t=[11,[0,0],2,1],e.push(t),t=[0,[0],0,4],e.push(t),t=[6,[1],0,8],e.push(t),t=[7,[1],2,4],e.push(t),t=[1,[-1],2,6],e.push(t),this.levelArray.push(e),(e=[]).push(t=[8,[1],1,0]),t=[0,[1,1,2],1,1],e.push(t),t=[1,[-1],1,3],e.push(t),t=[7,[0,2],1,5],e.push(t),t=[5,[1,2],0,8],e.push(t),t=[11,[-1],2,6],e.push(t),this.levelArray.push(e),(e=[]).push(t=[7,[0,0],2,0]),t=[10,[-1],0,1],e.push(t),t=[2,[0],0,4],e.push(t),t=[1,[-1],2,4],e.push(t),t=[0,[1,1,2],1,6],e.push(t),t=[3,[0,0],1,8],e.push(t),this.levelArray.push(e)}}),cc._RF.pop()},{}],board2:[function(e,t,i){"use strict";cc._RF.push(t,"fb925R+fD1FM7A0Ok6ZPhbe","board2");cc.Class({extends:cc.Component,properties:{restartBtn:{default:null,type:cc.Node}},onLoad:function(){this.pieces=[[cc.v2(0,0),cc.v2(0,1),cc.v2(1,0)],[cc.v2(0,0),cc.v2(0,1),cc.v2(0,2),cc.v2(1,0)],[cc.v2(0,0),cc.v2(0,1),cc.v2(1,0),cc.v2(1,1)],[cc.v2(0,0),cc.v2(0,1),cc.v2(1,0),cc.v2(1,-1),cc.v2(-1,1)],[cc.v2(0,0),cc.v2(0,-1),cc.v2(0,-2),cc.v2(1,0),cc.v2(2,0)],[cc.v2(0,0),cc.v2(0,-1),cc.v2(-1,0),cc.v2(1,0),cc.v2(2,0)],[cc.v2(0,0),cc.v2(-1,0),cc.v2(0,1),cc.v2(1,0),cc.v2(1,1)],[cc.v2(0,0),cc.v2(0,-1),cc.v2(0,1),cc.v2(0,2)],[cc.v2(0,0),cc.v2(0,-1),cc.v2(-1,-1),cc.v2(1,0),cc.v2(2,0)],[cc.v2(0,0),cc.v2(0,-1),cc.v2(0,1),cc.v2(1,0),cc.v2(-1,0)],[cc.v2(0,0),cc.v2(-1,0),cc.v2(-1,-1),cc.v2(1,0),cc.v2(1,-1)],[cc.v2(0,0),cc.v2(-1,0),cc.v2(-1,-1),cc.v2(1,0),cc.v2(2,0)]],this.piecesColor=[new cc.Color(255,100,155),new cc.Color(65,65,65),cc.Color.YELLOW,new cc.Color(255,100,0),new cc.Color(0,0,100),cc.Color.GREEN,cc.Color.BLUE,new cc.Color(0,100,0),cc.Color.MAGENTA,cc.Color.RED,cc.Color.GRAY,new cc.Color(255,90,200)],this.originPosition=cc.v2(-200,220),this.graphic=this.node.addComponent(cc.Graphics),this.createEmptyBoard(),this.drawChessBoard(),this.createOutsideSlot(),this.createPieces(),this.onSelectNode=this.pieceNode[0],this.restartBtn.zIndex=99},restartAction:function(){cc.director.loadScene("board2")},pieceCW:function(){this.onSelectNode.getComponent("piece2").turnBallNodeCW()},pieceCCW:function(){this.onSelectNode.getComponent("piece2").turnBallNodeCCW()},pieceFlip:function(){this.onSelectNode.getComponent("piece2").turnBallNodeFlip()},menuAction:function(){cc.director.loadScene("menu")},start:function(){},createPieces:function(){this.pieceNode=[];for(var e=0;e<this.pieces.length;e++){var t=new cc.Node("piece"),i=t.addComponent("piece2");i.init(this.pieces[e],this.piecesColor[e]),i.home=this,t.parent=cc.find("Canvas"),t.setPosition(this.outsideSlot[e].position),t.dragable=!0,t.zIndex=99,this.pieceNode.push(t)}},createEmptyBoard:function(){this.board=[];for(var e=0;e<11;e++){for(var t=[],i=0;i<5;i++){t.push(0)}this.board.push(t)}},drawChessBoard:function(){this.boardNode=[];for(var e=this.board.length,t=0;t<e;t++){for(var i=[],o=this.board[t].length,c=0;c<o;c++){var r=this.calPosition(this.originPosition,t,c),s=new cc.Node("boardSlot");s.parent=cc.find("Canvas"),s.setPosition(r),s.zIndex=0,s.withPiece=!1,i.push(s),this.drawSpot(r,new cc.Color(30,30,30))}this.boardNode.push(i)}},calPosition:function(e,t,i){var o=e.x+40*t,c=e.y+40*i*-1;return cc.v2(o,c)},drawSpot:function(e,t){this.graphic.fillColor=t,this.graphic.circle(e.x,e.y,20),this.graphic.stroke(),this.graphic.fill()},createOutsideSlot:function(){this.outsideSlot=[];for(var e=cc.v2(-320,-230),t=0;t<6;t++)for(var i=0;i<2;i++){var o=e.add(cc.v2(130*t,130*i)),c=new cc.Node("outsideSlot");c.parent=cc.find("Canvas"),c.setPosition(o),c.zIndex=1;var r=c.addComponent(cc.Graphics);r.moveTo(-65,65),r.lineTo(65,65),r.lineTo(65,-65),r.lineTo(-65,-65),r.close(),r.strokeColor=cc.Color.GRAY,r.stroke(),this.outsideSlot.push(c)}},checkWin:function(){for(var e=this.boardNode.length,t=0;t<e;t++)for(var i=this.boardNode[t].length,o=0;o<i;o++)if(!this.boardNode[t][o].withPiece)return!1;return this.restartBtn.active=!0,!0}}),cc._RF.pop()},{}],board3:[function(e,t,i){"use strict";cc._RF.push(t,"e245dz4LtZJ6b7MrZYGYAnA","board3");cc.Class({extends:cc.Component,properties:{restartBtn:{default:null,type:cc.Node},currentLevelLabel:{default:null,type:cc.Label}},onLoad:function(){this.pieces=[[cc.v2(0,0),cc.v2(0,1),cc.v2(1,0)],[cc.v2(0,0),cc.v2(0,1),cc.v2(0,2),cc.v2(1,0)],[cc.v2(0,0),cc.v2(0,1),cc.v2(1,0),cc.v2(1,1)],[cc.v2(0,0),cc.v2(0,1),cc.v2(1,0),cc.v2(1,-1),cc.v2(-1,1)],[cc.v2(0,0),cc.v2(0,-1),cc.v2(0,-2),cc.v2(1,0),cc.v2(2,0)],[cc.v2(0,0),cc.v2(0,-1),cc.v2(-1,0),cc.v2(1,0),cc.v2(2,0)],[cc.v2(0,0),cc.v2(-1,0),cc.v2(0,1),cc.v2(1,0),cc.v2(1,1)],[cc.v2(0,0),cc.v2(0,-1),cc.v2(0,1),cc.v2(0,2)],[cc.v2(0,0),cc.v2(0,-1),cc.v2(-1,-1),cc.v2(1,0),cc.v2(2,0)],[cc.v2(0,0),cc.v2(0,-1),cc.v2(0,1),cc.v2(1,0),cc.v2(-1,0)],[cc.v2(0,0),cc.v2(-1,0),cc.v2(-1,-1),cc.v2(1,0),cc.v2(1,-1)],[cc.v2(0,0),cc.v2(-1,0),cc.v2(-1,-1),cc.v2(1,0),cc.v2(2,0)]],this.piecesColor=[new cc.Color(255,100,155),new cc.Color(65,65,65),cc.Color.YELLOW,new cc.Color(255,100,0),new cc.Color(0,0,100),cc.Color.GREEN,cc.Color.BLUE,new cc.Color(0,100,0),cc.Color.MAGENTA,cc.Color.RED,cc.Color.GRAY,new cc.Color(255,90,200)],this.originPosition=cc.v2(-50,220),this.graphic=this.node.addComponent(cc.Graphics),this.createEmptyBoard(),this.drawChessBoard(),this.createOutsideSlot(),this.createPieces(),this.onSelectNode=this.pieceNode[0],this.restartBtn.zIndex=99,this.currentLevel=5},restartAction:function(){cc.director.loadScene("menu")},pieceCW:function(){this.onSelectNode.getComponent("piece3").turnBallNodeCW()},pieceCCW:function(){this.onSelectNode.getComponent("piece3").turnBallNodeCCW()},pieceFlip:function(){this.onSelectNode.getComponent("piece3").turnBallNodeFlip()},pieceRot1:function(){this.onSelectNode.getComponent("piece3").turnBallNodeRot1()},pieceRot2:function(){this.onSelectNode.getComponent("piece3").turnBallNodeRot2()},levelUpBtn:function(){this.currentLevel<5?this.currentLevel++:this.currentLevel=0,this.currentLevelLabel.getComponent(cc.Label).string=5===this.currentLevel?"All":this.currentLevel,this.drawOpacityByLevel(this.currentLevel)},levelDownBtn:function(){this.currentLevel>0?this.currentLevel--:this.currentLevel=5,this.currentLevelLabel.getComponent(cc.Label).string=5===this.currentLevel?"All":this.currentLevel,this.drawOpacityByLevel(this.currentLevel)},start:function(){},pieceV2ToV3:function(e){for(var t=e.length,i=[],o=0;o<t;o++){var c=cc.v3(e[o].x,e[o].y,0);i.push(c)}return i},createPieces:function(){this.pieceNode=[];for(var e=0;e<this.pieces.length;e++){var t=this.pieceV2ToV3(this.pieces[e]),i=new cc.Node("piece");i.scriptNode=i.addComponent("piece3"),i.scriptNode.init(t,this.piecesColor[e]),i.scriptNode.home=this,i.parent=cc.find("Canvas"),i.setPosition(this.outsideSlot[e].position),i.dragable=!0,i.zIndex=10,this.pieceNode.push(i)}},createEmptyBoard:function(){var e=5,t=5;this.board=[];for(var i=0;i<5;i++){for(var o=[],c=0;c<e;c++){for(var r=[],s=0;s<t;s++){r.push(0)}o.push(r)}e--,t--,this.board.push(o)}},drawChessBoard:function(){this.boardNode=[];for(var e=this.board.length,t=0;t<e;t++){for(var i=[],o=this.board[t].length,c=0;c<o;c++){for(var r=[],s=this.board[t][c].length,n=0;n<s;n++){var a=this.calPosition(this.originPosition,t,c,n),h=this.createEmptyNode(a,new cc.Color(30,30,30),t);r.push(h)}i.push(r)}this.boardNode.push(i)}},createEmptyNode:function(e,t,i){var o=new cc.Node("boardSlot");return cc.loader.loadRes("white_ball",cc.SpriteFrame,function(e,t){o.addComponent(cc.Sprite).spriteFrame=t}),o.zIndex=2*i,o.opacity=30,o.parent=cc.find("Canvas"),o.color=t,o.scale=.22,o.setPosition(e),o.withPiece=!1,o},calPosition:function(e,t,i,o){var c=e.x+40*Math.cos(20*Math.PI/180)*i-40*Math.cos(50*Math.PI/180)*o+7*Math.cos(10*Math.PI/180)*t,r=e.y-40*Math.sin(20*Math.PI/180)*i-40*Math.sin(50*Math.PI/180)*o+7*Math.sin(10*Math.PI/180)*t;return cc.v2(c,r)},drawSpot:function(e,t,i){e.fillColor=i,e.circle(0,0,20),e.stroke(),e.fill()},createOutsideSlot:function(){this.outsideSlot=[];for(var e=cc.v2(-320,-230),t=0;t<6;t++)for(var i=0;i<2;i++){var o=e.add(cc.v2(130*t,130*i)),c=new cc.Node("outsideSlot");c.parent=cc.find("Canvas"),c.setPosition(o),c.zIndex=1;var r=c.addComponent(cc.Graphics);r.moveTo(-65,65),r.lineTo(65,65),r.lineTo(65,-65),r.lineTo(-65,-65),r.close(),r.strokeColor=cc.Color.GRAY,r.stroke(),this.outsideSlot.push(c)}},drawOpacityByLevel:function(e){for(var t=this.boardNode.length,i=0;i<t;i++)for(var o=this.boardNode[i].length,c=0;c<o;c++)for(var r=this.boardNode[i][c].length,s=0;s<r;s++)this.boardNode.zIndex=2*i,this.boardNode[i][c][s].opacity=i===e?250:30;for(var n=0;n<this.pieceNode.length;n++)if(!this.pieceNode[n].scriptNode.turnable)for(var a=this.pieceNode[n].scriptNode.ballNodes.length,h=0;h<a;h++){var l=this.pieceNode[n].scriptNode.ballNodes[h].virtualPos.z;console.log("ballZ",l),this.pieceNode[n].scriptNode.ballNodes[h].zIndex=2*l+1,this.pieceNode[n].scriptNode.ballNodes[h].opacity=l===e?250:30}},checkWin:function(){for(var e=this.boardNode.length,t=0;t<e;t++)for(var i=this.boardNode[t].length,o=0;o<i;o++)for(var c=this.boardNode[t][o].length,r=0;r<c;r++)if(!this.boardNode[t][o][r].withPiece)return!1;return this.restartBtn.active=!0,!0}}),cc._RF.pop()},{}],menu:[function(e,t,i){"use strict";cc._RF.push(t,"13348LOoIJNloaiVRZRSdKs","menu"),cc.Class({extends:cc.Component,properties:{},board1Btn:function(){cc.director.loadScene("board1")},board2Btn:function(){cc.director.loadScene("board2")},board3Btn:function(){cc.director.loadScene("board3")},start:function(){}}),cc._RF.pop()},{}],piece1:[function(e,t,i){"use strict";cc._RF.push(t,"cf112K/Qm1NHY4cHaMM2Q7D","piece1");cc.Class({extends:cc.Component,properties:{interactable:!0,dragable:!0,_inDrag:!1,turnable:!0,fatherNodePosition:cc.v2(0,-310)},onEnable:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this)},onDisable:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this)},onLoad:function(){this.onEnable()},init:function(e,t){this.ballNodes=[],this.pieceArray=[];for(var i=e.length,o=0;o<i;o++){var c=e[o];this.pieceArray.push(c),this.createBallNode(e[o],t)}this.node.width=100,this.node.height=100},createBallNode:function(e,t){var i=new cc.Node("ball");cc.loader.loadRes("white_ball",cc.SpriteFrame,function(e,t){i.addComponent(cc.Sprite).spriteFrame=t}),i.opacity=255,i.parent=this.node,i.color=t,i.scale=.22;var o=this.calPosition(cc.v2(0,0),e.x,e.y);i.setPosition(o),this.ballNodes.push(i)},restPiece:function(e){this.pieceArray=[];for(var t=e.length,i=0;i<t;i++){var o=e[i];this.pieceArray.push(o);var c=this.calPosition(cc.v2(0,0),e[i].x,e[i].y);this.ballNodes[i].setPosition(c)}this.oringialPos=this.node.position,this.turnable=!0,this.dragable=!0},turnBallNodeCCW:function(){if(this.turnable)for(var e=this.pieceArray.length,t=0;t<e;t++){this.pieceArray[t]=cc.v2(this.pieceArray[t].y,-this.pieceArray[t].x);var i=this.calPosition(cc.v2(0,0),this.pieceArray[t].x,this.pieceArray[t].y);this.ballNodes[t].setPosition(i)}},turnBallNodeCW:function(){if(this.turnable)for(var e=this.pieceArray.length,t=0;t<e;t++){this.pieceArray[t]=cc.v2(-this.pieceArray[t].y,this.pieceArray[t].x);var i=this.calPosition(cc.v2(0,0),this.pieceArray[t].x,this.pieceArray[t].y);this.ballNodes[t].setPosition(i)}},turnBallNodeFlip:function(){if(this.turnable)for(var e=this.pieceArray.length,t=0;t<e;t++){this.pieceArray[t]=cc.v2(-this.pieceArray[t].x,this.pieceArray[t].y);var i=this.calPosition(cc.v2(0,0),this.pieceArray[t].x,this.pieceArray[t].y);this.ballNodes[t].setPosition(i)}},calPosition:function(e,t,i){var o=-1*Math.sqrt(2)*20,c=e.x+o*t*-1+o*i,r=e.y+o*t+o*i;return cc.v2(c,r)},_onTouchBegan:function(e){this.interactable&&this.enabledInHierarchy&&(this.dragable&&(this.oringialPos=this.node.position,this._dragTesting=!0,this.node.opacity=155,this.home.onSelectNode=this.node),e.stopPropagation())},_onTouchMove:function(e){if(this.interactable&&this.enabledInHierarchy){if(this._dragTesting&&!this._inDrag){if(this.dragable){var t=e.getStartLocation(),i=e.getLocation();i.subSelf(t),i.magSqr()>20&&(this._inDrag=!0,this.turnable=!0,cc.log("[drag] start drag"))}}else if(this._inDrag){var o=e.getStartLocation(),c=e.getLocation();c.subSelf(o);var r=this.oringialPos.add(c);this.node.setPosition(r),this.checkCollision()}e.stopPropagation()}},_onTouchEnded:function(e){this.interactable&&this.enabledInHierarchy&&(this._dragTesting=!1,this._inDrag&&(cc.log("[drag] stop drag"),this.pieceDrop()),this.dropable&&cc.log("[drop]"),this._inDrag=!1,this.node.opacity=255,this.node.setPosition(this.oringialPos),this.home.checkWin(),e.stopPropagation())},_onTouchCancel:function(e){this.interactable&&this.enabledInHierarchy&&(this._inDrag&&cc.log("[drag] stop drag"),this._inDrag=!1,this.node.opacity=255,this.node.setPosition(this.oringialPos),e.stopPropagation())},clearCurrentBoard:function(){if(this.dropableBoard)for(var e=0;e<this.dropableBoard.length;e++)this.dropableBoard[e].withPiece=!1},checkCollision:function(){this.clearCurrentBoard(),this.dropableBoard=[],this.dropablePiece=[];for(var e=this.ballNodes.length,t=0;t<e;t++){var i=this.node.position.add(this.ballNodes[t].position),o=this.checkDropableBoard(i);o&&(this.dropableBoard.push(o),this.dropablePiece.push(this.ballNodes[t]))}},checkDropableBoard:function(e){for(var t=this.home.board,i=this.home.boardNode,o=t.length,c=0;c<o;c++)for(var r=t[c].length,s=0;s<r;s++){if(!i[c][s].withPiece)if(i[c][s].position.sub(e).mag()<=20)return i[c][s]}},pieceDrop:function(){var e=this.dropablePiece.length,t=this.ballNodes.length;if(console.log("dropPieceLength",e),console.log("ballNodesLength",t),e===t){this.oringialPos=this.dropableBoard[0].position,this.node.opacity=255,this.turnable=!1;for(var i=0;i<e;i++)this.dropableBoard[i].withPiece=!0}var o=this.checkDropInOutsideSlot();o&&(this.oringialPos=o.position,this.turnable=!0)},checkLevelMoveDropable:function(e,t){for(var i=this.pieceArray.length,o=0;o<i;o++){var c=this.pieceArray[o].x+e,r=this.pieceArray[o].y+t;if(!this.home.boardNode[c])return!1;if(!this.home.boardNode[c][r])return!1;if(!0===this.home.boardNode[c][r].withPiece)return!1}return!0},movePiece:function(e,t){if(!this.checkLevelMoveDropable(e,t))return!1;this.oringialPos=this.home.boardNode[e][t].position;for(var i=this.pieceArray.length,o=0;o<i;o++){var c=this.pieceArray[o].x+e,r=this.pieceArray[o].y+t;this.home.boardNode[c][r].withPiece=!0}return this._inDrag=!1,this.node.opacity=255,this.turnable=!1,this.node.setPosition(this.oringialPos),this.dragable=!1,!0},moveOutSideSlot:function(e,t){for(var i=this.pieceArray.length,o=0;o<i;o++){var c=this.pieceArray[o].x+e,r=this.pieceArray[o].y+t;this.home.boardNode[c][r].withPiece=!1}this.oringialPos=this.home.outsideSlot[0].position,this.turnable=!0,this._inDrag=!1,this.dragable=!0,this.node.opacity=255,this.node.setPosition(this.oringialPos)},checkDropInOutsideSlot:function(){for(var e=this.home.outsideSlot,t=0;t<e.length;t++){if(this.node.position.sub(e[t].position).mag()<=80)return e[t]}},start:function(){}}),cc._RF.pop()},{}],piece2:[function(e,t,i){"use strict";cc._RF.push(t,"1e30dxA4RxIV7aLNnPWxjb/","piece2");cc.Class({extends:cc.Component,properties:{interactable:!0,dragable:!0,_inDrag:!1,turnable:!0},onEnable:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this)},onDisable:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this)},onLoad:function(){this.onEnable()},init:function(e,t){this.ballNodes=[],this.pieceArray=e;for(var i=e.length,o=0;o<i;o++)this.createBallNode(e[o],t);this.node.width=100,this.node.height=100},createBallNode:function(e,t){var i=new cc.Node("ball");cc.loader.loadRes("white_ball",cc.SpriteFrame,function(e,t){i.addComponent(cc.Sprite).spriteFrame=t}),i.opacity=255,i.parent=this.node,i.color=t,i.scale=.22;var o=this.calPosition(cc.v2(0,0),e.x,e.y);i.setPosition(o),this.ballNodes.push(i)},turnBallNodeCCW:function(){if(this.turnable)for(var e=this.pieceArray.length,t=0;t<e;t++){this.pieceArray[t]=cc.v2(this.pieceArray[t].y,-this.pieceArray[t].x);var i=this.calPosition(cc.v2(0,0),this.pieceArray[t].x,this.pieceArray[t].y);this.ballNodes[t].setPosition(i)}},turnBallNodeCW:function(){if(this.turnable)for(var e=this.pieceArray.length,t=0;t<e;t++){this.pieceArray[t]=cc.v2(-this.pieceArray[t].y,this.pieceArray[t].x);var i=this.calPosition(cc.v2(0,0),this.pieceArray[t].x,this.pieceArray[t].y);this.ballNodes[t].setPosition(i)}},turnBallNodeFlip:function(){if(this.turnable)for(var e=this.pieceArray.length,t=0;t<e;t++){this.pieceArray[t]=cc.v2(-this.pieceArray[t].x,this.pieceArray[t].y);var i=this.calPosition(cc.v2(0,0),this.pieceArray[t].x,this.pieceArray[t].y);this.ballNodes[t].setPosition(i)}},calPosition:function(e,t,i){var o=e.x+40*t,c=e.y+40*i*-1;return cc.v2(o,c)},_onTouchBegan:function(e){this.interactable&&this.enabledInHierarchy&&(this.dragable&&(this.oringialPos=this.node.position,this._dragTesting=!0,this.node.opacity=155,this.home.onSelectNode=this.node),e.stopPropagation())},_onTouchMove:function(e){if(this.interactable&&this.enabledInHierarchy){if(this._dragTesting&&!this._inDrag){if(this.dragable){var t=e.getStartLocation(),i=e.getLocation();i.subSelf(t),i.magSqr()>20&&(this._inDrag=!0,this.turnable=!0,cc.log("[drag] start drag"))}}else if(this._inDrag){var o=e.getStartLocation(),c=e.getLocation();c.subSelf(o);var r=this.oringialPos.add(c);this.node.setPosition(r),this.checkCollision()}e.stopPropagation()}},_onTouchEnded:function(e){this.interactable&&this.enabledInHierarchy&&(this._dragTesting=!1,this._inDrag&&(cc.log("[drag] stop drag"),this.pieceDrop()),this.dropable&&cc.log("[drop]"),this._inDrag=!1,this.node.opacity=255,this.node.setPosition(this.oringialPos),this.home.checkWin(),e.stopPropagation())},_onTouchCancel:function(e){this.interactable&&this.enabledInHierarchy&&(this._inDrag&&cc.log("[drag] stop drag"),this._inDrag=!1,this.node.opacity=255,this.node.setPosition(this.oringialPos),e.stopPropagation())},clearCurrentBoard:function(){if(this.dropableBoard)for(var e=0;e<this.dropableBoard.length;e++)this.dropableBoard[e].withPiece=!1},checkCollision:function(){this.clearCurrentBoard(),this.dropableBoard=[],this.dropablePiece=[];for(var e=this.ballNodes.length,t=0;t<e;t++){var i=this.node.position.add(this.ballNodes[t].position),o=this.checkDropableBoard(i);o&&(this.dropableBoard.push(o),this.dropablePiece.push(this.ballNodes[t]))}},checkDropableBoard:function(e){for(var t=this.home.board,i=this.home.boardNode,o=t.length,c=0;c<o;c++)for(var r=t[c].length,s=0;s<r;s++){if(!i[c][s].withPiece)if(i[c][s].position.sub(e).mag()<=20)return i[c][s]}},pieceDrop:function(){var e=this.dropablePiece.length,t=this.ballNodes.length;if(console.log("dropPieceLength",e),console.log("ballNodesLength",t),e===t){this.oringialPos=this.dropableBoard[0].position,this.node.opacity=255,this.turnable=!1;for(var i=0;i<e;i++)this.dropableBoard[i].withPiece=!0}var o=this.checkDropInOutsideSlot();o&&(this.oringialPos=o.position,this.turnable=!0)},checkDropInOutsideSlot:function(){for(var e=this.home.outsideSlot,t=0;t<e.length;t++){if(this.node.position.sub(e[t].position).mag()<=80)return e[t]}},start:function(){}}),cc._RF.pop()},{}],piece3:[function(e,t,i){"use strict";cc._RF.push(t,"2f3d2AiVbhGX6y5CLRuQeB7","piece3");cc.Class({extends:cc.Component,properties:{interactable:!0,dragable:!0,_inDrag:!1,turnable:!0},onEnable:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this)},onDisable:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this)},onLoad:function(){this.onEnable()},init:function(e,t){this.ballNodes=[],this.pieceArray=e;for(var i=e.length,o=0;o<i;o++)this.createBallNode(e[o],t);this.node.width=100,this.node.height=100},createBallNode:function(e,t){var i=new cc.Node("ball");cc.loader.loadRes("white_ball",cc.SpriteFrame,function(e,t){i.addComponent(cc.Sprite).spriteFrame=t}),i.zIndex=e.z,0==e.z?i.opacity=255:i.opacity=100,i.parent=this.node,i.color=t,i.scale=.22;var o=this.calPosition(cc.v2(0,0),e.z,e.x,e.y);i.setPosition(o),i.virtualPos=e,this.ballNodes.push(i)},turnBallNodeCCW:function(){if(this.turnable)for(var e=this.pieceArray.length,t=0;t<e;t++){this.pieceArray[t]=cc.v3(this.pieceArray[t].y,-this.pieceArray[t].x,this.pieceArray[t].z),this.ballNodes[t].virtualPos=this.pieceArray[t];var i=this.calPosition(cc.v2(0,0),this.pieceArray[t].z,this.pieceArray[t].x,this.pieceArray[t].y);this.ballNodes[t].setPosition(i)}},turnBallNodeCW:function(){if(this.turnable)for(var e=this.pieceArray.length,t=0;t<e;t++){this.pieceArray[t]=cc.v3(-this.pieceArray[t].y,this.pieceArray[t].x,this.pieceArray[t].z),this.ballNodes[t].virtualPos=this.pieceArray[t];var i=this.calPosition(cc.v2(0,0),this.pieceArray[t].z,this.pieceArray[t].x,this.pieceArray[t].y);this.ballNodes[t].setPosition(i)}},turnBallNodeFlip:function(){if(this.turnable)for(var e=this.pieceArray.length,t=0;t<e;t++){this.pieceArray[t]=cc.v3(-this.pieceArray[t].x,this.pieceArray[t].y,this.pieceArray[t].z),this.ballNodes[t].virtualPos=this.pieceArray[t];var i=this.calPosition(cc.v2(0,0),this.pieceArray[t].z,this.pieceArray[t].x,this.pieceArray[t].y);this.ballNodes[t].setPosition(i)}},turnBallNodeRot1:function(){if(this.turnable)for(var e=this.pieceArray.length,t=0;t<e;t++){var i=this.pieceArray[t].y,o=this.pieceArray[t].z+this.pieceArray[t].y,c=this.pieceArray[t].x-this.pieceArray[t].y;this.pieceArray[t]=cc.v3(i,o,c),this.ballNodes[t].virtualPos=this.pieceArray[t];var r=this.calPosition(cc.v2(0,0),this.pieceArray[t].z,this.pieceArray[t].x,this.pieceArray[t].y);this.ballNodes[t].setPosition(r),this.ballNodes[t].zIndex=c,0==c?this.ballNodes[t].opacity=255:c<0?this.ballNodes[t].opacity=50:c>0&&(this.ballNodes[t].opacity=100)}},turnBallNodeRot2:function(){if(this.turnable)for(var e=this.pieceArray.length,t=0;t<e;t++){var i=this.pieceArray[t].x+this.pieceArray[t].z,o=this.pieceArray[t].y+this.pieceArray[t].z,c=-this.pieceArray[t].x-this.pieceArray[t].y-this.pieceArray[t].z;this.pieceArray[t]=cc.v3(i,o,c),this.ballNodes[t].virtualPos=this.pieceArray[t];var r=this.calPosition(cc.v2(0,0),this.pieceArray[t].z,this.pieceArray[t].x,this.pieceArray[t].y);this.ballNodes[t].setPosition(r),this.ballNodes[t].zIndex=c,0==c?this.ballNodes[t].opacity=255:c<0?this.ballNodes[t].opacity=50:c>0&&(this.ballNodes[t].opacity=100)}},calPosition:function(e,t,i,o){var c=e.x+40*Math.cos(20*Math.PI/180)*i-40*Math.cos(50*Math.PI/180)*o+7*Math.cos(10*Math.PI/180)*t,r=e.y-40*Math.sin(20*Math.PI/180)*i-40*Math.sin(50*Math.PI/180)*o+7*Math.sin(10*Math.PI/180)*t;return cc.v2(c,r)},_onTouchBegan:function(e){this.interactable&&this.enabledInHierarchy&&(this.dragable&&(this.oringialPos=this.node.position,this._dragTesting=!0,this.node.opacity=155,this.home.onSelectNode=this.node),e.stopPropagation())},_onTouchMove:function(e){if(this.interactable&&this.enabledInHierarchy){if(this._dragTesting&&!this._inDrag){if(this.dragable){var t=e.getStartLocation(),i=e.getLocation();i.subSelf(t),i.magSqr()>20&&(this._inDrag=!0,this.turnable=!0,cc.log("[drag] start drag"))}}else if(this._inDrag){var o=e.getStartLocation(),c=e.getLocation();c.subSelf(o);var r=this.oringialPos.add(c);this.node.setPosition(r),this.checkCollision()}e.stopPropagation()}},_onTouchEnded:function(e){this.interactable&&this.enabledInHierarchy&&(this._dragTesting=!1,this._inDrag&&(cc.log("[drag] stop drag"),this.pieceDrop()),this.dropable&&cc.log("[drop]"),this._inDrag=!1,this.node.opacity=255,this.node.setPosition(this.oringialPos),this.home.checkWin(),e.stopPropagation())},_onTouchCancel:function(e){this.interactable&&this.enabledInHierarchy&&(this._inDrag&&cc.log("[drag] stop drag"),this._inDrag=!1,this.node.opacity=255,this.node.setPosition(this.oringialPos),e.stopPropagation())},clearCurrentBoard:function(){if(this.dropableBoard)for(var e=0;e<this.dropableBoard.length;e++)this.dropableBoard[e].withPiece=!1},checkCollision:function(){this.clearCurrentBoard(),this.dropableBoard=[],this.dropablePiece=[];for(var e=this.ballNodes.length,t=0;t<e;t++){if(0===this.dropableBoard.length)var i=this.node.position.add(this.ballNodes[t].position),o=this.checkDropableBoard(i);else o=this.checkDropableVirtualBoard(this.pieceArray[t],this.dropableBoard[0]);o&&(this.dropableBoard.push(o),this.dropablePiece.push(this.ballNodes[t]))}},checkDropableBoard:function(e){var t=this.home.boardNode,i=this.home.currentLevel;if(t[i])for(var o=t[i].length,c=0;c<o;c++)for(var r=t[i][c].length,s=0;s<r;s++){if(!t[i][c][s].withPiece)if(t[i][c][s].position.sub(e).mag()<=20)return console.log("orgindex",c,s),t[i][c][s]}},checkDropableVirtualBoard:function(e,t){var i=e.x,o=e.y,c=e.z,r=this.home.currentLevel,s=this.searchIndexXY(r,t);console.log("index",s[0],s[1]);var n=s[0]+i,a=s[1]+o,h=r+c,l=this.home.boardNode[h][n][a];if(console.log("searchNode",l),l&&!l.withPiece)return l},searchIndexXY:function(e,t){var i=this.home.boardNode,o=i[e].length;if(o)for(var c=0;c<o;c++){var r=i[e][c].indexOf(t);if(r>-1)return[c,r]}},pieceDrop:function(){var e=this.dropablePiece.length,t=this.ballNodes.length;if(console.log("dropPieceLength",e),console.log("ballNodesLength",t),e===t){this.oringialPos=this.dropableBoard[0].position,this.node.opacity=255,this.turnable=!1;for(var i=0;i<e;i++)this.dropableBoard[i].withPiece=!0,this.ballNodes[i].virtualPos.z=this.dropableBoard[i].zIndex/2}var o=this.checkDropInOutsideSlot();o&&(this.oringialPos=o.position,this.turnable=!0)},checkDropInOutsideSlot:function(){for(var e=this.home.outsideSlot,t=0;t<e.length;t++){if(this.node.position.sub(e[t].position).mag()<=80)return e[t]}},start:function(){}}),cc._RF.pop()},{}],solver1:[function(e,t,i){"use strict";cc._RF.push(t,"f7e20N3st1PZYSUJk2ukf0l","solver1"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},getRotCount:function(e){var t=1;switch(e){case 0:t=8;break;case 1:t=1;break;case 2:case 3:case 4:t=4;break;case 5:case 6:case 7:t=8;break;case 8:t=2;break;case 9:t=8;break;case 10:t=1;break;case 11:t=4}return t},judgeBtn:function(){var e=this.judgeFail();console.log("judge : ",e)},autoSolve:function(){this.board1=cc.find("Canvas").getComponent("board1");this.autoSolvePutPiece(0)},autoSolvePutPiece:function(e){for(var t=e;t<this.board1.pieceNode.length;t++)if(this.board1.pieceNode[t].scriptNode.turnable)for(var i=this.getRotCount(t),o=0;o<i;o++){for(var c=0;c<this.board1.boardNode.length;c++)for(var r=0;r<this.board1.boardNode[c].length;r++){var s=this.board1.pieceNode[t].scriptNode.movePiece(c,r),n=!0;if(s){if(this.board1.checkWin())return!0;n=this.judgeFail()}if(s&&!n)this.board1.pieceNode[t].scriptNode.moveOutSideSlot(c,r);else if(s&&t<11){if(!0===this.autoSolvePutPiece(t+1))return!0;this.board1.pieceNode[t].scriptNode.moveOutSideSlot(c,r)}}this.executeRot(t,o)}return!1},executeRot:function(e,t){switch(t){case 3:this.board1.pieceNode[e].scriptNode.turnBallNodeFlip();break;default:this.board1.pieceNode[e].scriptNode.turnBallNodeCW()}},judgeFail:function(){for(var e=this.board1.boardNode.length,t=0;t<e;t++)for(var i=this.board1.boardNode[t].length,o=0;o<i;o++)if(!this.board1.boardNode[t][o].withPiece){var c=1;if(this.board1.boardNode[t-1]&&this.board1.boardNode[t-1][o]&&(this.board1.boardNode[t-1][o].withPiece||c++),this.board1.boardNode[t+1]&&this.board1.boardNode[t+1][o]&&(this.board1.boardNode[t+1][o].withPiece||c++),this.board1.boardNode[t][o-1]&&(this.board1.boardNode[t][o-1].withPiece||c++),this.board1.boardNode[t][o+1]&&(this.board1.boardNode[t][o+1].withPiece||c++),c<2)return!1}return!0},start:function(){}}),cc._RF.pop()},{}]},{},["board1","board2","board3","menu","piece1","piece2","piece3","solver1"]);